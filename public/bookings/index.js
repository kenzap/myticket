!function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function e(e,a){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,a){if(e){if("string"==typeof e)return t(e,a);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,a):void 0}}(e))||a&&e&&"number"==typeof e.length){n&&(e=n);var s=0,o=function(){};return{s:o,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,d=!1;return{s:function(){n=n.call(e)},n:function(){var t=n.next();return i=t.done,t},e:function(t){d=!0,r=t},f:function(){try{i||null==n.return||n.return()}finally{if(d)throw r}}}}const a=(t,e,...a)=>{let n=(t,e)=>(e.forEach(((e,a)=>{t=t.replace("%"+(a+1)+"$",e)})),t);return void 0===window.i18n||void 0===window.i18n.state.locale.values[t]?n(t,a):n(e(window.i18n.state.locale.values[t]),a)},n=(t,...e)=>{if(0===(t=String(t)).length)return"";return a(t,(t=>t.replace(/[<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),...e)},s=(t,...e)=>{if(0===(t=String(t)).length)return"";return a(t,(t=>t.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),...e)},o=()=>{let t=document.querySelector(".loader");t&&(t.style.display="block")},r=t=>{let e=new URLSearchParams(window.location.search),a=e.get("sid")?e.get("sid"):"",n=-1==t.indexOf("?")?"?sid="+a:"&sid="+a;return t+n},i=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},d=(t,e,a)=>{let n="";if(a){let t=new Date;t.setTime(t.getTime()+24*a*60*60*1e3),n=";expires="+t.toUTCString()}document.cookie=t+"="+(escape(e)||"")+n+";path=/;domain=.kenzap.cloud"},c=t=>{let e=t+"=",a=decodeURIComponent(document.cookie).split(";");for(let t=0;t<a.length;t++){let n=a[t];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""},l=()=>{let t=localStorage.hasOwnProperty("header")&&localStorage.hasOwnProperty("header-version")?localStorage.getItem("header-version"):0,e=window.location.hostname+"/"+i()+"/"+c("locale");return e!=c("check")&&(t=0,console.log("refresh")),d("check",e,5),t},u=()=>({Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+c("kenzap_api_key"),"Kenzap-Locale":c("locale")?c("locale"):"en","Kenzap-Header":l(),"Kenzap-Token":c("kenzap_token"),"Kenzap-Sid":i()});c("kenzap_api_key"),c("locale")&&c("locale"),l(),c("kenzap_token"),i();const m=t=>{if(console.log(t),isNaN(t.code)){let e=t;try{e=JSON.stringify(e)}catch(t){}let a=new URLSearchParams;return a.append("cmd","report"),a.append("sid",i()),a.append("token",c("kenzap_token")),a.append("data",e),fetch("https://api-v1.kenzap.cloud/error/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:a}),void alert("Can not connect to Kenzap Cloud")}if(401===t.code){if(-1!=window.location.href.indexOf("localhost"))return void alert(t.reason);location.href="https://auth.kenzap.com/?app=65432108792785&redirect="+window.location.href}else alert(t.reason)},p=(t,e)=>{if(document.querySelector(t))for(let a of document.querySelectorAll(t))a.removeEventListener("click",e,!0),a.addEventListener("click",e,!0)},h=(t,e)=>{if(document.querySelector(t))for(let a of document.querySelectorAll(t))a.removeEventListener("change",e,!0),a.addEventListener("change",e,!0)},v=t=>{if(!document.querySelector(".toast")){let t='\n        <div class="toast-cont position-fixed bottom-0 p-2 m-4 end-0 align-items-center" style="z-index:10000;">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n                </div>\n            </div>\n        </div>';document.querySelector("body > div")&&document.querySelector("body > div").insertAdjacentHTML("afterend",t)}let e=new bootstrap.Toast(document.querySelector(".toast"));document.querySelector(".toast .toast-body").innerHTML=t,e.show()};var g=function(t){return(""+t).length<2?"0"+t:t},f=function(){return 0==window.location.host.indexOf("localhost")?"https://api.myticket-dev.app.kenzap.cloud/":"https://api.myticket.app.kenzap.cloud/"},b=function(t){return t=t||0,t=parseFloat(t),t=Math.round(100*t)/100},y=function(t,e){e=b(e),e=(Math.round(100*parseFloat(e))/100).toFixed(2);var a={};switch((a=t.currency_symb_loc?t:t.state.settings).currency_symb_loc){case"left":e=a.currency_symb+" "+e;break;case"right":e+=a.currency_symb}return e},w=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},k=function(t){return t=(t=(t=(t=(t=t.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#39;/g,"'")).replace(/&amp;/g,"&")},S=function(t,e,a){var n=(e=parseInt(e))-(a=parseInt(a));if(n<60)return t("moments ago");if(n<3600)return parseInt(n/60)+" "+t("minutes ago");if(n<86400)return parseInt(n/60/60)+" "+t("hours ago");var s=new Date(1e3*a),o=[t("Jan"),t("Feb"),t("Mar"),t("Apr"),t("May"),t("Jun"),t("Jul"),t("Aug"),t("Sep"),t("Oct"),t("Nov"),t("Dec")],r=s.getFullYear(),i=o[s.getMonth()],d=s.getDate();return s.getHours(),s.getMinutes(),s.getSeconds(),a=d+" "+i+" "+r},_={_this:null,state:{orderSingle:null},renderOrder:function(t,e){console.log(e.currentTarget.dataset.index),console.log(t.state.orderSingle),t.state.changes=!1,t.modal=document.querySelector(".order-modal"),t.modalCont=new bootstrap.Modal(t.modal),t.modalOpen=!0,t.rowMark=-1;var a=e.currentTarget.dataset.index;history.pushState({pageID:"orders"},"Orders",window.location.pathname+window.location.search+"#editing"),t.modal.addEventListener("hide.bs.modal",(function(t){-1!=window.location.href.indexOf("#editing")&&history.pushState({pageID:"orders"},"Orders",window.location.pathname+window.location.search)})),void 0===a?t.state.orderSingle={_id:"new",created:1649831099,from:"dine-in",id:"",idd:"",items:[],kid:"0",note:"",sid:i(),status:"new",price:{discount_percent:0},step:1,total:0,updated:1649833845}:(t.state.orderSingle=t.state.orders[a],t.state.orderSingle.status||(t.state.orderSingle.status="new"),console.log(t.state.orderSingle),_.renderOrderUI(t)),p(".print-ticket",(function(e){e.preventDefault(),fetch(f(),{method:"post",headers:u(),body:JSON.stringify({query:{order:{type:"view-ticket",trans_id:t.state.orderSingle.trans_id}}})}).then((function(t){return t.blob()})).then((function(t){if(document.querySelector(".print-ticket").dataset.loading="",t.size<100)t.text().then((function(t){JSON.parse(t).success}));else{var e=URL.createObjectURL(t);window.open(e)}})).catch((function(t){m(t)}))})),p(".print-invoice",(function(e){e.preventDefault(),fetch(f(),{method:"post",headers:u(),body:JSON.stringify({query:{order:{type:"view-invoice",trans_id:t.state.orderSingle.trans_id}}})}).then((function(t){return t.blob()})).then((function(t){if(document.querySelector(".print-invoice").dataset.loading="",t.size<100)t.text().then((function(t){JSON.parse(t).success}));else{var e=URL.createObjectURL(t);window.open(e)}})).catch((function(t){m(t)}))})),t.listeners.modalSuccessBtnFunc=function(e){e.preventDefault(),t.updateOrder(a,t.state.orderSingle._id)},p(".st-modal li a",(function(e){e.preventDefault(),_._this.state.changes=!0;var a=document.querySelector("#order-status-modal");a.innerHTML=t.state.statuses[e.currentTarget.dataset.key].text,a.dataset.value=e.currentTarget.dataset.key;Object.keys(t.state.statuses).forEach((function(e){t.state.statuses[e].class.split(" ").forEach((function(t){a.classList.remove(t)}))})),t.state.statuses[e.currentTarget.dataset.key].class.split(" ").forEach((function(t){a.classList.add(t)}))}))},renderOrderUI:function(t){_.state.orderSingle=t.state.orderSingle;var e="";Object.keys(t.state.statuses).forEach((function(a,n){e+='<li><a class="dppi dropdown-item" data-key="'.concat(a,'" href="#">').concat(t.state.statuses[a].text,"</a></li>")}));var a='\n        <div class="d-flex justify-content-between">\n            <div class="st-modal st-opts mb-3 me-1 me-sm-3 dropdown">\n                <a class="btn btn-sm '.concat(t.state.statuses[t.state.orderSingle.status].class,' dropdown-toggle order-form" data-id="status" data-type="key" data-value="').concat(t.state.orderSingle.status,'" href="#" role="button" id="order-status-modal" data-bs-toggle="dropdown" aria-expanded="false" >\n                    ').concat(t.state.statuses[t.state.orderSingle.status].text,'\n                </a>\n                <ul class="dropdown-menu" aria-labelledby="order-status-modal">\n                    ').concat(e,'\n                </ul>\n            </div>\n            <div class="mb-3 me-1 me-sm-3 dropdown">\n                <a class="btn btn-sm dropdown-toggle-" href="#" role="button" id="order-actions" data-bs-toggle="dropdown" aria-expanded="false" >\n                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">\n                        <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>\n                    </svg>\n                </a>\n                <ul class="dropdown-menu" aria-labelledby="order-actions">\n                    <li><a class="dppi dropdown-item print-invoice" data-key="invoice" href="#">').concat(s("Invoice"),'</a></li>\n                    <li><a class="dppi dropdown-item print-ticket" data-key="ticket" href="#">').concat(s("Ticket"),"</a></li>\n                </ul>\n            </div>\n        </div>\n        ");t.modal.querySelector(".modal-dialog").classList.add("modal-fullscreen"),t.modal.querySelector(".modal-header .modal-title").innerHTML=isNaN(t.state.orderSingle.from)?t.state.orderSingle.title:"#"+t.state.orderSingle.from,t.modal.querySelector(".modal-footer .btn-confirm").innerHTML="new"==t.state.orderSingle._id?__("Create"):__("Update"),t.modal.querySelector(".btn-confirm").dataset.loading=!1,t.modal.querySelector(".modal-footer .btn-secondary").innerHTML=__("Close");var o=a,d="https://cdn.kenzap.com/loading.png";void 0===t.state.orderSingle.data.img&&(t.state.orderSingle.data.img=[]),t.state.orderSingle.data.img[0]&&(d=CDN+"/S"+i()+"/event-"+t.state.orderSingle.data._id+"-1-250.webp");var c=!1;t.state.orderSingle.checkout.holders.forEach((function(t){t.ticket&&t.ticket.type&&(c=!0)})),o+='\n        <div class="mb-4 mt-3 order-row keyx-meta" >\n            <h5>'.concat(t.state.orderSingle.title,'</h5>\n            <div class="mb-2">\n                <a href="').concat(r("/event-edit/?id="+t.state.orderSingle.data._id),'"><img src="').concat(d,'" data-srcset="').concat(d,'" class="img-fluid rounded" alt="').concat(n("Events placeholder"),'" srcset="').concat(d,'" ></a>\n            </div>\n            <div class="d-flex align-items-center">\n                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar4-week me-2" viewBox="0 0 16 16">\n                    <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v1h14V3a1 1 0 0 0-1-1H2zm13 3H1v9a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V5z"/>\n                    <path d="M11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-2 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z"/>\n                </svg>\n                <div>&nbsp;').concat((t.state.orderSingle.data.eventbegins?new Date(t.state.orderSingle.data.eventbegins).toLocaleDateString():"")+" "+new Date(t.state.orderSingle.data.eventbegins).toLocaleTimeString().slice(0,5)," ").concat(t.state.orderSingle.data.eventends?"- "+new Date(t.state.orderSingle.data.eventends).toLocaleDateString()+" "+new Date(t.state.orderSingle.data.eventends).toLocaleTimeString().slice(0,5):"","</div>\n            </div>\n            <div>\n                ").concat(t.state.orderSingle.data.eventlocation,"\n            </div>\n            <div>\n                ").concat(s("Event type")," ").concat(t.state.orderSingle.data.eventvenue,"\n            </div>\n            <div>\n                ").concat(s("Quantity")," ").concat(t.state.orderSingle.quantity,'\n            </div>\n        </div>\n        <div class="mb-4 mt-3 order-row keyx-from" >\n            <h5>').concat(s("From"),"</h5>\n            <div>").concat((t.state.orderSingle.email?t.state.orderSingle.email:"")+" "+(t.state.orderSingle.checkout.lname?t.state.orderSingle.checkout.lname:""),"</div>\n            <div>").concat((t.state.orderSingle.checkout.fname?t.state.orderSingle.checkout.fname:"")+" "+(t.state.orderSingle.checkout.lname?t.state.orderSingle.checkout.lname:""),"</div>\n            <div>").concat(t.state.orderSingle.checkout.email?t.state.orderSingle.checkout.email:"","</div>\n            <div>").concat(t.state.orderSingle.checkout.addr1?t.state.orderSingle.checkout.addr1:"","</div>\n            <div>").concat(t.state.orderSingle.checkout.addr2?t.state.orderSingle.checkout.addr2:"","</div>\n            <div>").concat(t.state.orderSingle.checkout.city?t.state.orderSingle.checkout.city:"","</div>\n            <div>").concat(t.state.orderSingle.checkout.postal?t.state.orderSingle.checkout.postal:"",'</div>\n        </div>\n        <div class="mb-4 mt-3 order-row keyx-holders" >\n            <h5>').concat(s("Ticket holders"),'</h5>\n            <table class="table table-hover table-borderless align-middle">\n                <tr>\n                    <th>').concat(s("Status"),"</th>\n                    <th>").concat(s("Holder"),'</th>\n                    <th class="').concat(c?"":"d-none",'">').concat(s("Ticket"),"</th>\n                    <th>").concat(s("Time"),'</th>\n                    <th class="text-end">').concat(s("Actions"),"</th>\n                </tr>\n            ").concat(t.state.orderSingle.checkout.holders.map((function(e,a){return e.ticket||(e.ticket={}),e.ticket.cfs||(e.ticket.cfs=[]),'\n                    <tr>\n                        <td>\n                            <div class="form-check form-switch">\n                                <input class="form-check-input" type="checkbox" disabled="true" id="ticket_status'.concat(a,'" ').concat(e.status&&"validated"==e.status?"checked":"",'>\n                                <label class="form-check-label" for="ticket_status').concat(a,'"></label>\n                            </div>\n                        </td>\n                        <td>').concat(e.name," ").concat(e.email,'</td>\n                        <td class="').concat(c?"":"d-none",'">\n                            ').concat(e.ticket.seat_text?"<div>"+s("Seat %1$",e.ticket.seat_text)+"</div>":"","\n                            ").concat(e.ticket.seat_row?"<div>"+s("Row %1$",e.ticket.seat_row)+"</div>":"","\n                            ").concat(e.ticket.type?"<div>"+s("Type %1$",e.ticket.type)+"</div>":"","\n                            ").concat(e.ticket.zone_text?"<div>"+s("Zone %1$",e.ticket.zone_text)+"</div>":"","\n                            ").concat(e.ticket.cfs.map((function(t){return t.label?"<div>"+s(t.label+" %1$",e.ticket[t.id])+"</div>":""})).join("")," \n                        </td>\n                        <td>").concat(e.utc?new Date(e.utc).toLocaleDateString()+" "+new Date(e.utc).toLocaleTimeString().slice(0,5):"",'</td>\n                        <td class="text-end">\n                            <a class="btn btn-sm dropdown-toggle-" href="#" role="button" id="ticket-actions" data-bs-toggle="dropdown" aria-expanded="false">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">\n                                    <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"></path>\n                                </svg>\n                            </a>\n                            <ul class="dropdown-menu" aria-labelledby="ticket-actions" style="">\n                                <li><a class="dppi dropdown-item print-ticket-individual" data-index="').concat(a,'" data-trans_id="').concat((n=t.state.orderSingle.trans_id,0===(n=String(n)).length?"":n.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),'" data-key="ticket" href="#">').concat(s("Ticket"),'</a></li>\n                                <li><a class="dppi dropdown-item edit-ticket-individual d-none" data-index="').concat(a,'" data-key="edit" href="#">').concat(s("Edit"),'</a></li>\n                                <li><a class="dppi dropdown-item remove-ticket-individual d-none" data-index="').concat(a,'" data-key="remove" href="#">').concat(s("Remove"),"</a></li>\n                            </ul>\n                        </td>\n                    </tr>\n                    ");var n})).join(""),'\n            </table>\n        </div>\n        <div class="mb-4 mt-3 order-row keyx-id" >\n            <h5>').concat(s("Booking ID"),"</h5>\n            ").concat(t.state.orderSingle._id,"\n        </div>\n        ").concat(t.state.orderSingle.checkout.coupon?'\n        <div class="mb-4 mt-3 order-row keyx-coupon" >\n            <h5>'.concat(s("Coupon"),"</h5>\n            ").concat(t.state.orderSingle.checkout.coupon.coupon+" "+t.state.orderSingle.checkout.coupon.type+" "+t.state.orderSingle.checkout.coupon.amount,"\n        </div>\n        "):"","\n        "),setTimeout((function(){_.refreshTotals()}),100),o+="",t.modal.querySelector(".modal-body").innerHTML='<div class="modal-body-cont">'+o+"</div>",t.modalCont.show(),_.viewTicketListeners(),"new"==t.state.orderSingle._id&&_.refreshTotals()},newOrder:function(t){_._this=t,p(".add-order",(function(e){_.renderOrder(t,e)}))},viewOrder:function(t){_._this=t,p(".view-order",(function(e){_.renderOrder(t,e)}))},itemOptions:function(t){return'\n\n        <div class="dropdown text-center">\n            <a  href="#" role="button" id="order-item-options" data-id="status" data-value="" data-bs-toggle="dropdown" aria-expanded="false">\n                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical order-item-options" viewBox="0 0 16 16"><path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/></svg>\n            </a>\n            <ul class="dropdown-menu" aria-labelledby="order-item-options" >\n                <li><a class="oio dropdown-item edit-item-note" data-key="edit-item-note" href="#">'.concat(__("Add note"),'</a></li>\n                <li><a class="oio dropdown-item d-none" data-key="edit-item-variation" href="#">').concat(__("Add variation"),'</a></li>\n                <li><a class="oio dropdown-ite d-none" data-key="edit-item-price" href="#">').concat(__("Adjust price"),'</a></li>\n                <li><a class="oio dropdown-item text-danger remove-item" data-key="remove-item" href="#">').concat(__("Remove"),"</a></li>\n            </ul>\n        </div>\n    ")},structOrderItemTable:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];t.created!=a[e].created&&(t.rowMark+=1),t.created=a[e].created,a[e].cats=a[e].cats?a[e].cats:[];var r="",i="";for(var d in a[e].variations){var c="";for(var l in a[e].variations[d].list)c+=s(a[e].variations[d].list[l].title)+" ";r+='<div><b class="me-1">'+s(a[e].variations[d].title)+"</b> <span>"+c+"</span></div> ",void 0!==a[e].variations[d].note&&a[e].variations[d].note.length>0&&(r+="<div><b>"+__("Note")+"</b> "+a[e].variations[d].note+"</div> ")}var u="";return a[e].discount_percent&&(u=" (-"+a[e].discount_percent+"%)"),a[e].discount_value&&(u=" (-"+y(t,a[e].discount_value)+")"),a[e].discounts||(a[e].discounts=[]),a[e].discounts.forEach((function(t){"never"==t.type&&(a[e].discount_type="never")})),i+='<tr class="order-item-row-active row-mark'+t.rowMark+'" data-created="'+a[e].created+'" data-x="'+e+'" data-id="'+a[e].id+'" data-vars="'+w(JSON.stringify(a[e].variations))+'" data-cats="'+w(JSON.stringify(a[e].cats))+'" data-discounts="'+w(JSON.stringify(a[e].discounts))+'">',i+='<td><div class="item-title" contenteditable="false" data-value="'+a[e].title+'" data-sdesc="'+(a[e].sdesc?a[e].sdesc:"")+'">'+s(a[e].title)+'</div><div class="item-note text-muted mb-1 '+(0!=a[e].note.length&&"<br>"!=a[e].note||n?"":"d-none")+'" contenteditable="true" data-value="'+a[e].note+'">'+a[e].note+'</div><div class="vars border-primary item-variations my-1 ps-2 text-secondary" data-value="">'+r+'</div></td><td class="qty"><div class="me-1 me-sm-3 item-qty" data-value="'+a[e].qty+'">'+a[e].qty+'</div></td><td class="tp"><div class="me-1 me-sm-3 item-total" data-price="'+a[e].price+'" data-value="'+a[e].total+'" data-discount_type="'+(a[e].discount_type?a[e].discount_type:"")+'" data-discount_percent="'+(a[e].discount_percent?a[e].discount_percent:"")+'" data-discount_value="'+(a[e].discount_value?a[e].discount_value:"")+'">'+y(t,a[e].total)+u+'</div><td class="'+(o?"":"d-none")+'">'+_.itemOptions(a[e])+"</td></td>",i+="</tr>"},viewTicketListeners:function(t){p(".print-ticket-individual",(function(t){t.preventDefault(),fetch(f(),{method:"post",headers:u(),body:JSON.stringify({query:{order:{type:"view-ticket",trans_id:t.currentTarget.dataset.trans_id,holder:t.currentTarget.dataset.index}}})}).then((function(t){return t.blob()})).then((function(t){if(document.querySelector(".print-ticket").dataset.loading="",t.size<100)t.text().then((function(t){JSON.parse(t).success}));else{var e=URL.createObjectURL(t);window.open(e)}})).catch((function(t){m(t)}))}))},refreshTotals:function(){var t='<div class="mb-2 mt-2 order-total-subtotal order-row text-right elipsized keyx-total">\n                <b>'.concat(s("Amount"),'</b><div class="ms-2 d-inline-block" data-type="key-number" >').concat(y(_.state.orderSingle.data.settings,b(_.state.orderSingle.amount)/100*_.state.orderSingle.quantity),"</div>\n             </div>");document.querySelector(".modal-body-cont").insertAdjacentHTML("beforeend",'<div class="mt-5 order-total order-form text-end" data-type="price" >'.concat(t,"</div>"))}},x=function(t){return'\n      <div class="container ec-orders">\n        <div class="d-md-flex justify-content-between bd-highlight mb-3">\n            <nav class="bc" aria-label="breadcrumb"></nav>\n            <button class="btn btn-primary add-order btn-add mt-3 mb-1 mt-md-0 mb-md-0 d-none" type="button">'.concat(s("Manual booking"),'</button>\n        </div>\n\n        <div class="d-md-flex justify-content-between bd-highlight mb-3">\n          <div>\n            <div class="col-md-12 page-title">\n              <div class="st-opts st-table dropdown">\n                  <a class="btn btn-outline-secondary dropdown-toggle" href="#" role="button" id="order-status" data-id="status" data-value="" data-bs-toggle="dropdown" aria-expanded="false">\n                    ').concat(s("All"),'\n                  </a>\n                  <ul class="dropdown-menu" aria-labelledby="order-status">\n                    <li><a class="dppi dropdown-item" data-key="" href="#" >').concat(s("All"),'</a></li>\n                    <li><a class="dppi dropdown-item" data-key="new" href="#" >').concat(s("New"),'</a></li>\n                    <li class="d-none"><a class="dppi dropdown-item" data-key="paid" href="#" >').concat(s("Paid"),'</a></li>\n                    <li><a class="dppi dropdown-item" data-key="processing" href="#" >').concat(s("Processing"),'</a></li>\n                    <li><a class="dppi dropdown-item" data-key="completed" href="#" >').concat(s("Completed"),'</a></li>\n                    <li><a class="dppi dropdown-item" data-key="canceled" href="#" >').concat(s("Canceled"),'</a></li>\n                    <li><a class="dppi dropdown-item" data-key="failed" href="#" >').concat(s("Failed"),'</a></li>\n                    <li><a class="dppi dropdown-item" data-key="refunded" href="#" >').concat(s("Refunded"),'</a></li>\n                  </ul>\n              </div>\n              <div class="st-opts" >\n                <div class="input-group-sm mb-0 justify-content-start mb-sm-0" >\n                  <input id="usearch" type="text" class="inp form-control search-input" autocomplete="off" placeholder="').concat(s("Search booking"),'">\n                </div>\n                \x3c!-- <a id="viewSum" href="#" style="margin-left:16px;">view summary</a> --\x3e\n              </div>\n            </div>\n          </div>\n          <div class="qr-print-cnt align-self-center my-3 my-md-0">\n            <div class="d-flex align-items-center">\n              <div class="me-3 po print-attendee-list">\n                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-printer" viewBox="0 0 16 16">\n                  <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/>\n                  <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>\n                </svg>\n              </div>\n              <label class="form-check-label me-3" for="checkinmode">').concat(s("Check-in mode"),'</label>\n              <div class="form-check form-switch mb-0">\n                <input class="form-check-input" type="checkbox" id="checkinmode" ').concat("1"==c("checkinmode")?"checked":"",'>\n              </div>\n            </div>\n          </div> \n        </div>\n\n        <div id="orders-after-header">\n\n\n        </div>\n\n        <div class="row">\n            <div class="col-lg-12 grid-margin stretch-card mb-3">\n                <select class="form-select event-pick form-select-lg border-0 shadow-sm" aria-label=".form-select-lg example">\n                    <option value="" selected>').concat(s("All Events"),"</option>\n                    ").concat(t.state.events.map((function(e){return'<option value="'.concat(e._id,'" ').concat(t.state.eventid==e._id?"selected":""," >").concat((a=e.title,0===(a=String(a)).length?"":a.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),"</option>");var a})).join(""),'\n                </select>\n            </div>\n        </div>\n\n        <div class="row">\n          <div class="col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card">\n            <div class="card border-white shadow-sm border-0">\n              <div class="card-body p-0">\n \n                <div class="table-responsive">\n                  <table class="table table-hover table-borderless align-middle table-striped table-p-list mb-0">\n                    <thead>\n\n                    </thead>\n                    <tbody class="list">\n\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="modal order-modal" tabindex="-1" data-backdrop="static" data-keyboard="false">\n        <div class="modal-dialog ">\n          <div class="modal-content">\n              <div class="modal-header">\n                <h5 class="modal-title"></h5>\n                <button type="button" class="btn-close align-self-start-remove" data-bs-dismiss="modal" aria-label="Close"></button>\n              </div>\n              <div class="modal-body">\n              \n              </div>\n              <div class="modal-footer">\n                <button type="button" class="btn btn-primary btn-confirm"></button>\n                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n              </div>\n          </div>\n        </div>\n      </div>\n\n    ')},z={state:{firstLoad:!0,changes:!1,modalCont:null,modalOpen:!1,orderIDs:[],user:{},orders:[],settings:{},qr_settings:{},orderSingle:[],updates:{last_order_id:"",last_order_update:0},playTitleTimer:null,refreshTimer:null,timeout:null,statuses:[],event_id:"",limit:200,slistLimit:10,productsSuggestions:[]},init:function(){z.getData()},getData:function(){z.state.firstLoad&&o();var t=document.querySelector(".search-input")?document.querySelector(".search-input").value:"";if(!document.querySelector("body.modal-open")){var e=[];z.state.event_id&&e.push({type:"string",field:"event_id",value:z.state.event_id,relation:"="}),document.querySelector("#order-status")&&document.querySelector("#order-status").dataset.value&&(e.push({type:"string",field:"status",value:document.querySelector("#order-status").dataset.value,relation:"="}),console.log(document.querySelector("#order-status").dataset.value)),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:u(),body:JSON.stringify({query:{user:{type:"authenticate",fields:["avatar","id"],token:c("kenzap_token")},locale:{type:"locale",source:["extension"],key:"ecommerce"},orders:{type:"find",key:"myticket-order",fields:["id","amount","checkout","status","created","data","email","_id","trans_id","title","type","test","quantity","amount"],term:e,limit:z.state.limit,search:{s:t},sortby:{field:"created",order:"DESC"}},events:{type:"find",key:"myticket-event",fields:["_id","id","img","status","variations","title"],limit:50},settings:{type:"get",key:"ecommerce-settings",fields:["currency","currency_symb","currency_symb_loc","tax_calc","tax_percent_auto","tax_percent","tax_display","fee_calc","fee_percent","fee_display","payment_methods","custom_payment_method","tables","table_list","add_products","add_products_list","templates"]}}})}).then((function(t){return t.json()})).then((function(t){var e;(()=>{let t=document.querySelector(".loader");t&&(t.style.display="none")})(),t.success?(z.state.user=t.user,z.state.orders=t.orders,z.state.meta=t.meta,z.state.settings=t.settings,z.state.events=t.events,(t=>{if(t.header&&localStorage.setItem("header",t.header),!document.querySelector("#k-script")){let t=document.createElement("div");t.innerHTML=localStorage.getItem("header"),t=t.firstChild,document.body.prepend(t),Function(document.querySelector("#k-script").innerHTML).call("test")}t.locale&&window.i18n.init(t.locale)})(t),z.loadPageStructure(),z.render(t),z.initListeners(),e=s("MyTicket 2.0.8 by %1$Kenzap%2$. ❤️ Licensed %3$GPLv3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/ecommerce" target="_blank">',"</a>"),document.querySelector("footer .row").innerHTML='\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">'.concat(e,'</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">').concat("","</span>\n    </div>"),z.state.firstLoad=!1):m(t)})).catch((function(t){m(t)}))}},authUser:function(t){t.user&&t.user.success},loadPageStructure:function(){z.state.firstLoad&&(document.querySelector("#contents").innerHTML=x(z))},render:function(t){z.state.firstLoad&&((t=>{let e='<ol class="breadcrumb mt-2 mb-0">';for(let a of t)void 0===a.link?e+=`<li class="breadcrumb-item">${a.text}</li>`:e+=`<li class="breadcrumb-item"><a href="${a.link}">${a.text}</a></li>`;e+="</ol>",document.querySelector(".bc").innerHTML=e})([{link:r("https://dashboard.kenzap.cloud?launcher=myticket"),text:s("Home")},{link:r("/"),text:s("MyTicket")},{text:s("Bookings")}]),z.state.statuses={new:{text:s("New"),class:"btn-warning text-dark fw-light"},processing:{text:s("Processing"),class:"btn-primary fw-light"},completed:{text:s("Completed"),class:"btn-success fw-light"},canceled:{text:s("Canceled"),class:"btn-secondary fw-light"},archived:{text:s("Archived"),class:"btn-secondary fw-light"},failed:{text:s("Failed"),class:"btn-danger fw-light"},refunded:{text:s("Refunded"),class:"btn-danger fw-light"}}),z.state.settings.templates||(z.state.settings.templates=[]),0!=t.orders.length?(z.state.newOrderCount=[],document.querySelector("#checkinmode").checked?(document.querySelector(".table thead").innerHTML='\n                <tr>\n                    <th>\n                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#212529" class="bi justify-content-end bi-search mb-1" viewBox="0 0 16 16" >\n                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>\n                    </svg>\n                    </th>\n                    <th><span class="ps-1">'.concat(s("From"),'</span></th>\n                    <th class="d-none d-sm-table-cell">').concat(s("Status"),"</th>\n                    <th>").concat(s("Tickets"),'</th>\n                    <th class="d-none d-sm-table-cell">').concat(s("Time"),"</th>\n                    <th></th>\n                </tr>"),document.querySelector(".table tbody").innerHTML=t.orders.map((function(e,a){var o="https://cdn.kenzap.com/loading.png";return""==e.data&&(e.data=e.checkout.event),void 0===e.data.img&&(e.data.img=[]),e.data.img[0]&&(o=parseInt(e.created)<1680978e3?CDN+"/S"+i()+"/event-"+e.data._id+"-1-100x100.jpeg":CDN+"/S"+i()+"/event-"+e.data._id+"-1-100x100.webp"),'\n                    <tr class="new">\n                        <td>\n                            <div class="timgc">\n                                <a href="'.concat(r("/event-edit/?id="+e.data._id),'"><img src="').concat(o,'" data-srcset="').concat(o,'" class="img-fluid rounded" alt="').concat(n("Events placeholder"),'" srcset="').concat(o,'" ></a>\n                            </div>\n                        </td>\n                        <td class="details view-order" data-id="').concat(e._id,'" data-index="').concat(a,'">\n                            <div class="ps-1 t-data" >\n                                <div class="d-flex"><b class="me-2">').concat(e.id,"</b> ").concat(e.test&&"test"==e.test?'<div class="badge bg-warning fw-light text-dark">'.concat(s("Test"),"</div>"):"",'</div>\n                                <div class="elipsized my-1 my-sm-0">').concat(e.title,'</div>\n                                <div class="elipsized fst-italic">').concat(e.name?e.name:"",'</div>\n                                <div class="d-sm-none d-flex align-items-center"><span class="me-2">').concat(z.formatStatus(e.status),'</span> <span class="text-muted">').concat(S(__,t.meta.time,e.created),'</span> </div>\n                            </div>\n                        </td>\n                        <td class="d-none d-sm-table-cell">\n                            <span class="fs-12">').concat(z.formatStatus(e.status),"</span>\n                        </td>\n                        <td>\n                            <table>\n                            ").concat(e.checkout.holders.map((function(t,a){return'\n                                    <tr>\n                                        <td class="py-2">\n                                            <div class="form-check form-switch mb-0 me-2 ">\n                                                <input class="form-check-input ticket_status po" type="checkbox" id="ticket_status'.concat(a,'" data-_id="').concat(e._id,'" data-index="').concat(a,'" ').concat(t.status&&"validated"==t.status?"checked":"",'>\n                                                <label class="form-check-label" for="ticket_status').concat(a,'"></label>\n                                            </div>\n                                        </td>\n                                        <td class="py-2 td-holder elipsized">').concat(t.name," ").concat(t.email,'</td>\n                                        <td class="py-2 d-none">').concat(t.utc?new Date(t.utc).toLocaleDateString()+" "+new Date(t.utc).toLocaleTimeString().slice(0,5):"",'</td>\n                                        <td class="text-end py-2 d-none">\n                                            <a class="btn btn-sm dropdown-toggle-" href="#" role="button" id="ticket-actions" data-bs-toggle="dropdown" aria-expanded="false">\n                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">\n                                                    <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"></path>\n                                                </svg>\n                                            </a>\n                                            <ul class="dropdown-menu" aria-labelledby="ticket-actions" >\n                                                <li><a class="dppi dropdown-item print-ticket-individual" data-index="').concat(a,'" data-trans_id="').concat(z.state.orderSingle.trans_id,'" data-key="ticket" href="#">').concat(s("Ticket"),'</a></li>\n                                                <li><a class="dppi dropdown-item edit-ticket-individual d-none" data-index="').concat(a,'" data-key="edit" href="#">').concat(s("Edit"),'</a></li>\n                                                <li><a class="dppi dropdown-item remove-ticket-individual" data-index="').concat(a,'" data-key="remove" href="#">').concat(s("Remove"),"</a></li>\n                                            </ul>\n                                        </td>\n                                    </tr>\n                                    ")})).join(""),'\n                            </table>\n                        </td>\n                        <td class="d-none d-sm-table-cell td-time">\n                            <span style="font-size:18px;">').concat(S(__,t.meta.time,e.created),'</span>\n                        </td>\n                        <td class="last">\n                            <a href="#" data-id="').concat(e._id,'" data-index="').concat(a,'" class="view-order text-success d-none me-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">\n                                <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>\n                                <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>\n                            </svg></a>\n                            <a href="#" data-id="').concat(e._id,'" data-index="').concat(a,'" class="print-order-dis d-none text-success me-2">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-printer me-2" viewBox="0 0 16 16">\n                                <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/>\n                                <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>\n                            </svg></a>\n                            <a href="#" data-id="').concat(e._id,'" data-index="').concat(a,'" class="remove-order text-danger me-2"><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">\n                                <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>\n                                <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>\n                            </svg></a>\n                        </td>\n                    </tr>')})).join("")):(document.querySelector(".table thead").innerHTML='\n            <tr>\n                <th>\n                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#212529" class="bi justify-content-end bi-search mb-1" viewBox="0 0 16 16" >\n                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>\n                </svg>\n                </th>\n                <th><span class="ps-1">'.concat(s("From"),'</span></th>\n                <th class="d-none d-sm-table-cell">').concat(s("Status"),"</th>\n                <th>").concat(s("Total"),'</th>\n                <th class="d-none d-sm-table-cell">').concat(s("Time"),"</th>\n                <th></th>\n            </tr>"),document.querySelector(".table tbody").innerHTML=t.orders.map((function(e,a){var o="https://cdn.kenzap.com/loading.png";return""==e.data&&(e.data=e.checkout.event),void 0===e.data.img&&(e.data.img=[]),e.data.img[0]&&(o=parseInt(e.created)<1680978e3?CDN+"/S"+i()+"/event-"+e.data._id+"-1-100x100.jpeg":CDN+"/S"+i()+"/event-"+e.data._id+"-1-100x100.webp"),'\n                    <tr class="new">\n                        <td>\n                            <div class="timgc">\n                                <a href="'.concat(r("/event-edit/?id="+e.data._id),'"><img src="').concat(o,'" data-srcset="').concat(o,'" class="img-fluid rounded" alt="').concat(n("Events placeholder"),'" srcset="').concat(o,'" ></a>\n                            </div>\n                        </td>\n                        <td class="details view-order" data-id="').concat(e._id,'" data-index="').concat(a,'">\n                            <div class="ps-1 t-data" >\n                                <div class="d-flex"><b class="me-2">').concat(e.id,"</b> ").concat(e.test&&"test"==e.test?'<div class="badge bg-warning fw-light text-dark">'.concat(s("Test"),"</div>"):"",'</div>\n                                <div class="my-1 my-sm-0">').concat(e.email,'</div>\n                                <div class="elipsized fst-italic">').concat(e.name?e.name:"",'</div>\n                                <div class="d-sm-none d-flex align-items-center"><span class="me-2">').concat(z.formatStatus(e.status),'</span> <span class="text-muted">').concat(S(__,t.meta.time,e.created),'</span> </div>\n                            </div>\n                        </td>\n                        <td class="d-none d-sm-table-cell">\n                            <span class="fs-12">').concat(z.formatStatus(e.status),'</span>\n                        </td>\n                        <td>\n                            <span style="font-size:18px;">').concat(y(z,parseFloat(e.amount)/100*e.quantity),'</span>\n                        </td>\n                        <td class="d-none d-sm-table-cell td-time">\n                            <span style="font-size:18px;">').concat(S(__,t.meta.time,e.created),'</span>\n                        </td>\n                        <td class="last">\n                            <a href="#" data-id="').concat(e._id,'" data-index="').concat(a,'" class="view-order text-success d-none me-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">\n                                <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>\n                                <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>\n                            </svg></a>\n                            <a href="#" data-id="').concat(e._id,'" data-index="').concat(a,'" class="print-order-dis d-none text-success me-2">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-printer me-2" viewBox="0 0 16 16">\n                                <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/>\n                                <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>\n                            </svg></a>\n                            <a href="#" data-id="').concat(e._id,'" data-index="').concat(a,'" class="remove-order text-danger me-2"><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">\n                                <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>\n                                <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>\n                            </svg></a>\n                        </td>\n                    </tr>')})).join(""))):document.querySelector(".table tbody").innerHTML='<tr><td colspan="5">'.concat(s("No orders to display."),"</td></tr>")},getStatus:function(t){return'<div class="badge '.concat(z.state.statuses[t].class,'">').concat(z.state.statuses[t].text,"</div>")},formatStatus:function(t){switch(t){case"new":return'<div class="badge bg-warning text-dark fw-light">'.concat(s("New"),"</div>");case"processing":return'<div class="badge bg-primary fw-light">'.concat(s("Processing"),"</div>");case"completed":return'<div class="badge bg-success fw-light">'.concat(s("Completed"),"</div>");case"canceled":return'<div class="badge bg-secondary fw-light">'.concat(s("Canceled"),"</div>");case"archived":return'<div class="badge bg-secondary fw-light">'.concat(s("Archived"),"</div>");case"failed":return'<div class="badge bg-danger fw-light">'.concat(s("Failed"),"</div>");case"refunded":return'<div class="badge bg-danger fw-light">'.concat(s("Refunded"),"</div>");default:return'<div class="badge bg-warning fw-light text-dark">'.concat(s("New"),"</div>")}},initListeners:function(){_.viewOrder(z),p(".remove-order",z.listeners.removeOrder),p(".st-table li a",z.listeners.changeStatus),h(".ticket_status",z.listeners.checkInStatus),z.state.firstLoad&&(p(".modal .btn-primary",z.listeners.modalSuccessBtn),p(".print-attendee-list",z.listeners.printList),((t,e)=>{if(document.querySelector(t))for(let a of document.querySelectorAll(t))a.removeEventListener("keyup",e,!0),a.addEventListener("keyup",e,!0)})(".search-input",z.listeners.searchOrders),h("#checkinmode",z.listeners.checkInMode),h(".event-pick",(function(t){o(),z.state.event_id=t.currentTarget.value,z.getData()})),window.addEventListener("hashchange",(function(t){if(z.modalCont)return t.preventDefault(),z.modalOpen=!1,z.modalCont.hide(),!1})))},listeners:{newOrder:function(t){},checkInMode:function(t){d("checkinmode",document.querySelector("#checkinmode").checked?"1":"0"),z.getData()},printList:function(t){v(__("Loading")),fetch(f(),{method:"post",headers:u(),body:JSON.stringify({query:{order:{type:"view-attendee-list",s:document.querySelector("#usearch").value}}})}).then((function(t){return t.blob()})).then((function(t){document.querySelector(".print-attendee-list").dataset.loading="";var e=URL.createObjectURL(t);window.open(e)})).catch((function(t){m(t)}))},checkInStatus:function(t){var e={checkout:z.state.orders.filter((function(e){return e._id==t.currentTarget.dataset._id}))[0].checkout};e.checkout.holders[t.currentTarget.dataset.index].status=t.currentTarget.checked?"validated":"completed",e.checkout.holders[t.currentTarget.dataset.index].utc=(new Date).toISOString(),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:u(),body:JSON.stringify({query:{order:{type:"update",key:"myticket-order",id:t.currentTarget.dataset._id,sid:i(),data:e}}})}).then((function(t){return t.json()})).then((function(t){t.success?v(__("Booking updated")):m(t)})).catch((function(t){m(t)}))},changeStatus:function(t){t.preventDefault();var e=document.querySelector("#order-status");""==t.currentTarget.dataset.key?(e.innerHTML=s("All"),e.dataset.value=""):(e.innerHTML=z.state.statuses[t.currentTarget.dataset.key].text,e.dataset.value=t.currentTarget.dataset.key);Object.keys(z.state.statuses).forEach((function(t){z.state.statuses[t].class.split(" ").forEach((function(t){e.classList.remove(t)})),e.classList.remove("btn-outline-secondary")})),""==t.currentTarget.dataset.key?e.classList.add("btn-outline-secondary"):z.state.statuses[t.currentTarget.dataset.key].class.split(" ").forEach((function(t){e.classList.add(t)})),z.getData()},removeOrder:function(t){t.preventDefault(),confirm(__("Remove this booking?"))&&fetch(f(),{method:"post",headers:u(),body:JSON.stringify({query:{product:{type:"delete-order",id:t.currentTarget.dataset.id,sid:i()}}})}).then((function(t){return t.json()})).then((function(t){t.success?z.getData():m(t)})).catch((function(t){m(t)}))},searchOrders:function(t){t.preventDefault(),z.state.timeout&&clearTimeout(z.state.timeout),z.state.timeout=setTimeout((function(){z.getData()}),800)},modalSuccessBtn:function(t){z.listeners.modalSuccessBtnFunc(t)},modalSuccessBtnFunc:null},updateOrder:function(t,a){var n=document.querySelector(".modal");if("true"!==n.querySelector(".btn-confirm").dataset.loading){n.querySelector(".btn-confirm").dataset.loading=!0,n.querySelector(".btn-confirm").innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+s("Loading..");var o,r={},d=e(document.querySelectorAll(".order-form"));try{for(d.s();!(o=d.n()).done;){var c=o.value;switch(c.dataset.type){case"key":r[c.dataset.id]=c.dataset.value;break;case"key-number":r[c.dataset.id]=b(c.dataset.value);break;case"items":r.items=[];var l,p=e(document.querySelectorAll(".order-item-row-active"));try{for(p.s();!(l=p.n()).done;){var h=l.value,y=JSON.parse(k(h.dataset.vars)),w=JSON.parse(k(h.dataset.cats)),S=JSON.parse(k(h.dataset.discounts)),x={id:h.dataset.id,qty:parseInt(h.querySelector(".item-qty").dataset.value),cats:w||[],discounts:S||[],note:h.querySelector(".item-note").innerHTML,type:"new",index:"0",price:parseFloat(h.querySelector(".item-total").dataset.price),sdesc:h.querySelector(".item-title").dataset.sdesc,title:h.querySelector(".item-title").dataset.value,total:parseFloat(h.querySelector(".item-total").dataset.value),variations:"new"==a?[]:y||[]};h.querySelector(".item-total").dataset.discount_percent&&(x.discount_percent=h.querySelector(".item-total").dataset.discount_percent),h.querySelector(".item-total").dataset.discount_value&&(x.discount_value=h.querySelector(".edit-total").dataset.discount_value),r.items.push(x)}}catch(t){p.e(t)}finally{p.f()}break;case"text":r[c.dataset.id]=c.innerHTML;break;case"email":case"emails":case"select":case"textarea":r[c.id]=c.value;break;case"radio":r[c.id]=c.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector("input:checked").value}}}catch(t){d.e(t)}finally{d.f()}var q=new Date;r.created_ymd=q.getUTCFullYear()+""+g(q.getUTCMonth()+1)+g(q.getUTCDate()),r.created_ym=q.getUTCFullYear()+""+g(q.getUTCMonth()+1),r.created_y=q.getUTCFullYear()+"",r.printed=!!z.state.printRequest,r.notify=!1,_._this.state.changes=!1,"new"==a?(r.name=r.from,r.customer={first_name:r.from,last_name:"",kid:0},fetch(f(),{method:"post",headers:u(),body:JSON.stringify({query:{order:{type:"create-order",key:"ecommerce-order",data:r}}})}).then((function(t){return t.json()})).then((function(t){t.success?(z.modalCont.hide(),v(__("Order created")),z.getData()):m(t)})).catch((function(t){m(t)}))):fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:u(),body:JSON.stringify({query:{order:{type:"update",key:"myticket-order",id:a,sid:i(),data:r}}})}).then((function(t){return t.json()})).then((function(t){t.success?(z.modalCont.hide(),v(__("Order updated")),z.getData()):m(t)})).catch((function(t){m(t)}))}}};z.init()}();
