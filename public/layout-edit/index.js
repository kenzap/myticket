!function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function n(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}function o(t){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},o(t)}function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return s(t)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=o(t);if(e){var r=o(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return c(this,n)}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function u(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}var p=function(t){var e=new URLSearchParams(window.location.search),n=e.get("sid")?e.get("sid"):"",a=-1==t.indexOf("?")?"?sid="+n:"&sid="+n;return t+a},h=function(){var t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},g=function(t){for(var e=t+"=",n=decodeURIComponent(document.cookie).split(";"),a=0;a<n.length;a++){for(var r=n[a];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(e))return r.substring(e.length,r.length)}return""},f=function(t){t.code,alert(t.reason)},m=function(t,e){if(document.querySelector(t)){var n,a=u(document.querySelectorAll(t));try{for(a.s();!(n=a.n()).done;){var r=n.value;r.removeEventListener("click",e,!0),r.addEventListener("click",e,!0)}}catch(t){a.e(t)}finally{a.f()}}},v=function(){var t=document.querySelector(".loader");t&&(t.style.display="block")},b=n((function e(n){var r,o;t(this,e),a(this,"CLASS_NAMES",{SELECTED:"selected",WITH_HREF:"with_href"}),a(this,"getOffset",(function(t){var e=t.getBoundingClientRect();return{x:Math.round(e.left+window.pageXOffset),y:Math.round(e.top+window.pageYOffset)}})),a(this,"getRightCoords",(function(t,e){return{x:t-app.getOffset("x"),y:e-app.getOffset("y")}})),a(this,"getOffset",(function(t){switch(t){case"x":case"y":return state.offset[t]}})),a(this,"id",(function(t){return document.getElementById(t)})),a(this,"hide",(function(t){return t.style.display="none",this})),a(this,"show",(function(t){return t.style.display="block",this})),a(this,"encode",(function(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")})),a(this,"foreach",(function(t,e){for(var n=0,a=t.length;n<a;n++)e(t[n],n)})),a(this,"foreachReverse",(function(t,e){for(var n=t.length-1;n>=0;n--)e(t[n],n)})),a(this,"debug",(r=document.getElementById("debug"),function(){r.innerHTML=[].join.call(arguments," ")})),a(this,"stopEvent",(function(t){return t.stopPropagation(),t.preventDefault(),this})),a(this,"getUrlParameter",(function(t){var e,n,a=window.location.search.substring(1).split("&");for(n=0;n<a.length;n++)if((e=a[n].split("="))[0]===t)return void 0===e[1]||decodeURIComponent(e[1])})),a(this,"getCookie",(function(t){for(var e=t+"=",n=decodeURIComponent(document.cookie).split(";"),a=0;a<n.length;a++){for(var r=n[a];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(e))return unescape(r.substring(e.length,r.length))}return""})),a(this,"extend",(function(t,e){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=e[a]?e[a]:t[a]);return n})),a(this,"genID",(function(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<t;a++)e+=n.charAt(Math.floor(Math.random()*n.length));return e})),a(this,"inherits",(o=function(){},function(t,e){o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t})),this._app=n})),y=n((function e(n,r,o,i,s){if(t(this,e),a(this,"ABSTRACT_METHOD",(function(){throw new Error("This is abstract method")})),a(this,"redraw",(function(t){return this.setSVGCoords(t||this._coords),this})),a(this,"remove",(function(){this._app.removeNodeFromSvg(this._groupEl)})),a(this,"move",(function(t,e){return this.setCoords(this.edit("move",t,e)).redraw(),this})),a(this,"rotate",(function(t,e){return this.setCoords(this.edit("move",t,e)).redraw(),this})),a(this,"newID",(function(){return this._attributes.id=this.utils.genID(6),this.redraw(),this})),a(this,"select",(function(){return this._el.classList.add(e.CLASS_NAMES.SELECTED),this})),a(this,"deselect",(function(){return this._el.classList.remove(e.CLASS_NAMES.SELECTED),this})),a(this,"setStyleOfElementWithHref",(function(){return this._el.classList.add(e.CLASS_NAMES.WITH_HREF),this})),a(this,"unsetStyleOfElementWithHref",(function(){return this._el.classList.remove(e.CLASS_NAMES.WITH_HREF),this})),a(this,"setInfoAttributes",(function(t){this._attributes.id=t.id,this._attributes.href=t.href,this._attributes.alt=t.alt,this._attributes.title=t.title})),a(this,"toJSON",(function(){return{type:this._type,title:this._title,seats:this._seats,coords:this._coords,attributes:this._attributes}})),a(this,"createAreasFromHTMLOfMap",(function(t){if(!t)return!1;for(;;){var n=e.REGEXP.AREA.exec(t);if(!n)break;var a=n[0],r=n[1],o=n[2].split(e.REGEXP.DELIMETER),i={};e.ATTRIBUTES_NAMES.forEach((function(t,n){var r=e.REGEXP[t].exec(a);r&&(i[name]=r[1])})),o=o.map((function(t){return Number(t)})),r=e.HTML_NAMES_TO_AREA_NAMES[r],e.fromJSON(this._app,{type:r,coords:e.CONSTRUCTORS[r].getCoordsFromHTMLArray(o),seats:seats,attributes:i})}return Boolean(a)})),this.constructor===e)throw new Error("This is abstract class");this.utils=new b(r),e.CONSTRUCTORS[n]=this,this._type=n,this._app=r,this._seats=i,this._attributes={id:this.utils.genID(6),href:"",points:[]},this._groupEl=document.createElementNS(e.SVG_NS,"g"),s?(this.setInfoAttributes(s),this._groupEl.dataset.id=s.id):(this.setInfoAttributes(this._attributes),this._groupEl.dataset.id=this._attributes.id),this._coords=o,this._app.addNodeToSvg(this._groupEl),this._groupEl.obj=this,this._el=null,this._helpers={},this._app.addObject(this)}));a(y,"SVG_NS","http://www.w3.org/2000/svg"),a(y,"CLASS_NAMES",{SELECTED:"selected",WITH_HREF:"with_href"}),a(y,"CONSTRUCTORS",{}),a(y,"REGEXP",{AREA:/<area(?=.*? shape="(rect|circle|poly)")(?=.*? coords="([\d ,]+?)")[\s\S]*?>/gim,HREF:/ href="([\S\s]+?)"/,ALT:/ alt="([\S\s]+?)"/,TITLE:/ title="([\S\s]+?)"/,DELIMETER:/ ?, ?/}),a(y,"HTML_NAMES_TO_AREA_NAMES",{rect:"rectangle",circle:"circle",poly:"polygon"}),a(y,"ATTRIBUTES_NAMES",["ID","HREF","ALT","TITLE"]),a(y,"fromJSON",(function(t,e){return t.fromJSONArea(e)})),a(y,"genID",(function(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<t;a++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}));var _=n((function e(n,r,o,i){t(this,e),a(this,"setCoords",(function(t,n){return this._el.setAttribute("x",t+e.OFFSET),this._el.setAttribute("y",n+e.OFFSET),this})),a(this,"setId",(function(t){return this._el.n=t,this})),this._el=document.createElementNS(y.SVG_NS,"rect"),this._el.classList.add(e.CLASS_NAME),this._el.setAttribute("height",e.SIZE),this._el.setAttribute("width",e.SIZE),this._el.setAttribute("x",r+e.OFFSET),this._el.setAttribute("y",o+e.OFFSET),n.appendChild(this._el),this._el.action=i,this._el.classList.add(e.ACTIONS_TO_CURSORS[i])}));a(_,"SIZE",6),a(_,"OFFSET",-Math.ceil(_.SIZE/2)),a(_,"CLASS_NAME","helper"),a(_,"ACTIONS_TO_CURSORS",{move:"move",editLeft:"e-resize",editRight:"w-resize",editTop:"n-resize",editBottom:"s-resize",editTopLeft:"nw-resize",editTopRight:"ne-resize",editBottomLeft:"sw-resize",editBottomRight:"se-resize",movePoint:"pointer"});var w=function(e){r(i,e);var o=d(i);function i(e,n,r,c){var d;t(this,i),a(s(d=o.call(this,"rectangle",e,n,r,c)),"setSVGCoords",(function(t){this._el.setAttribute("x",t.x),this._el.setAttribute("y",t.y),this._el.setAttribute("width",t.width),this._el.setAttribute("height",t.height);var e=t.y,n=t.y+t.height/2,a=t.y+t.height,r=t.x,o=t.x+t.width/2,i=t.x+t.width;return this._helpers.center.setCoords(o,n),this._helpers.top.setCoords(o,e),this._helpers.bottom.setCoords(o,a),this._helpers.left.setCoords(r,n),this._helpers.right.setCoords(i,n),this._helpers.topLeft.setCoords(r,e),this._helpers.topRight.setCoords(i,e),this._helpers.bottomLeft.setCoords(r,a),this._helpers.bottomRight.setCoords(i,a),this})),a(s(d),"setCoords",(function(t){return this._coords.x=t.x,this._coords.y=t.y,this._coords.width=t.width,this._coords.height=t.height,this})),a(s(d),"dynamicDraw",(function(t,e,n){var a={x:this._coords.x,y:this._coords.y,width:t-this._coords.x,height:e-this._coords.y};return n&&(a=this.getSquareCoords(a)),a=this.getNormalizedCoords(a),this.redraw(a),a})),a(s(d),"onProcessDrawing",(function(t){var e=utils.getRightCoords(t.pageX,t.pageY);this.dynamicDraw(e.x,e.y,t.shiftKey)})),a(s(d),"onStopDrawing",(function(t){var e=utils.getRightCoords(t.pageX,t.pageY);this.setCoords(this.dynamicDraw(e.x,e.y,t.shiftKey)).deselect(),app.removeAllEvents().setIsDraw(!1).resetNewArea()})),a(s(d),"edit",(function(t,e,n){var a=Object.create(this._coords);switch(t){case"move":a.x+=e,a.y+=n;break;case"editLeft":a.x+=e,a.width-=e;break;case"editRight":a.width+=e;break;case"editTop":a.y+=n,a.height-=n;break;case"editBottom":a.height+=n;break;case"editTopLeft":a.x+=e,a.y+=n,a.width-=e,a.height-=n;break;case"editTopRight":a.y+=n,a.width+=e,a.height-=n;break;case"editBottomLeft":a.x+=e,a.width-=e,a.height+=n;break;case"editBottomRight":a.width+=e,a.height+=n}return a})),a(s(d),"dynamicEdit",(function(t,e){return t=this.getNormalizedCoords(t),e&&(t=this.getSavedProportionsCoords(t)),this.redraw(t),t})),a(s(d),"onProcessEditing",(function(t){return this.dynamicEdit(this.edit(app.getEditType(),t.pageX-this.editingStartPoint.x,t.pageY-this.editingStartPoint.y),t.shiftKey)})),a(s(d),"onStopEditing",(function(t){this.setCoords(this.onProcessEditing(t)),app.removeAllEvents()})),a(s(d),"toString",(function(){return"Rectangle {x: "+this._coords.x+", y: "+this._coords.y+", width: "+this._coords.width+", height: "+this._coords.height+"}"})),a(s(d),"toHTMLMapElementString",(function(){var t=this._coords.x+this._coords.width,e=this._coords.y+this._coords.height;return'<area shape="rect" coords="'+this._coords.x+", "+this._coords.y+", "+t+", "+e+'"'+(this._attributes.href?' href="'+this._attributes.href+'"':"")+(this._attributes.alt?' alt="'+this._attributes.alt+'"':"")+(this._attributes.title?' title="'+this._attributes.title+'"':"")+" />"})),a(s(d),"getCoordsForDisplayingInfo",(function(){return{x:this._coords.x,y:this._coords.y}})),a(s(d),"testCoords",(function(t){return t.x&&t.y&&t.width&&t.height})),a(s(d),"testHTMLCoords",(function(t){return 4===t.length})),a(s(d),"getCoordsFromHTMLArray",(function(t){if(!this.testHTMLCoords(t))throw new Error("This html-coordinates is not valid for rectangle");return{x:t[0],y:t[1],width:t[2]-t[0],height:t[3]-t[1]}})),a(s(d),"getNormalizedCoords",(function(t){return t.width<0&&(t.x+=t.width,t.width=Math.abs(t.width)),t.height<0&&(t.y+=t.height,t.height=Math.abs(t.height)),t})),a(s(d),"getSquareCoords",(function(t){var e=Math.abs(t.width),n=Math.abs(t.height);return e>n?t.width=t.width>0?n:-n:t.height=t.height>0?e:-e,t})),a(s(d),"getSavedProportionsCoords",(function(t,e){var n=t.width/t.height;return e.width/e.height>n?t.width=Math.round(t.height*n):t.height=Math.round(t.width/n),t})),a(s(d),"createAndStartDrawing",(function(t){var e=new i({x:t.x,y:t.y,width:0,height:0});return app.addEvent(app.domElements.container,"mousemove",e.onProcessDrawing.bind(e)).addEvent(app.domElements.container,"click",e.onStopDrawing.bind(e)),e})),d.app=e,d._coords={x:n.x||0,y:n.y||0,width:n.width||0,height:n.height||0},d._el=document.createElementNS(y.SVG_NS,"rect"),d._groupEl.appendChild(d._el);var l=n.x-d._coords.width/2,u=n.y-d._coords.height/2;return d._helpers={center:new _(d._groupEl,l,u,"move"),top:new _(d._groupEl,l,u,"editTop"),bottom:new _(d._groupEl,l,u,"editBottom"),left:new _(d._groupEl,l,u,"editLeft"),right:new _(d._groupEl,l,u,"editRight"),topLeft:new _(d._groupEl,l,u,"editTopLeft"),topRight:new _(d._groupEl,l,u,"editTopRight"),bottomLeft:new _(d._groupEl,l,u,"editBottomLeft"),bottomRight:new _(d._groupEl,l,u,"editBottomRight")},d.redraw(),d}return n(i)}(y);function x(t,e){return e.map((e=>function(t,e){return Array.isArray(e)?[t.a*e[0]+t.c*e[1]+t.e,t.b*e[0]+t.d*e[1]+t.f]:{x:t.a*e.x+t.c*e.y+t.e,y:t.b*e.x+t.d*e.y+t.f}}(t,e)))}function S(t){return void 0===t}function A(t,e=0){return{a:1,c:0,e:t,b:0,d:1,f:e}}function E(...t){const e=(t,e)=>({a:t.a*e.a+t.c*e.b,c:t.a*e.c+t.c*e.d,e:t.a*e.e+t.c*e.f+t.e,b:t.b*e.a+t.d*e.b,d:t.b*e.c+t.d*e.d,f:t.b*e.e+t.d*e.f+t.f});switch((t=Array.isArray(t[0])?t[0]:t).length){case 0:throw new Error("no matrices provided");case 1:return t[0];case 2:return e(t[0],t[1]);default:{const[n,a,...r]=t;return E(e(n,a),...r)}}}function k(...t){return E(...t)}const{cos:L,sin:C,PI:T}=Math;function M(t,e,n){return function(t,e,n){const a=L(t),r=C(t),o={a:a,c:-r,e:0,b:r,d:a,f:0};return S(e)||S(n)?o:E([A(e,n),o,A(-e,-n)])}(t*T/180,e,n)}function O(t,e,n,a){this.message=t,this.expected=e,this.found=n,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,O)}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(O,Error),O.buildMessage=function(t,e,n){var a={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?i(t[0])+"-"+i(t[1]):i(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description},not:function(t){return"not "+s(t.expected)}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function s(t){return a[t.type](t)}return"Expected "+function(t){var e,n,a=t.map(s);if(a.sort(),a.length>0){for(e=1,n=1;e<a.length;e++)a[e-1]!==a[e]&&(a[n]=a[e],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(e)+" found."};var D=function(e){r(i,e);var o=d(i);function i(e,n,r,c){var d;t(this,i),a(s(d=o.call(this,"polygon",e,n,r,c)),"close",(function(){var t=d._el;d._el=document.createElementNS(y.SVG_NS,"polygon"),d._groupEl.replaceChild(d._el,t),d._coords.isOpened=!1,d.redraw().deselect()})),a(s(d),"setSVGCoords",(function(t){var e=t.points.reduce((function(t,e){return t+e.x+" "+e.y+" "}),"");return d._el.setAttribute("points",e),d.foreach(d._helpers.points,(function(e,n){e.setCoords(t.points[n].x,t.points[n].y)})),s(d)})),a(s(d),"foreach",(function(t,e){for(var n=0,a=t.length;n<a;n++)e(t[n],n)})),a(s(d),"getRightCoords",(function(t,e,n){return{x:e-t.getOffset("x"),y:n-t.getOffset("y")}})),a(s(d),"setCoords",(function(t){return d._coords.points=t.points,s(d)})),a(s(d),"addPoint",(function(t,e){if(!d._coords.isOpened)throw new Error("This polygon is closed!");var n=new _(d._groupEl,t,e,"movePoint");return n.setId(d._helpers.points.length),d._helpers.points.push(n),d._coords.points.push({x:t,y:e}),d.redraw(),s(d)})),a(s(d),"dynamicDraw",(function(t,e,n,a){var r={points:[].concat(d._coords.points)};if(a){var o=i.getRightAngleLineLastPointCoords(d._coords,{x:e,y:n});e=o.x,n=o.y}return r.points.push({x:e,y:n}),d.redraw(r),r})),a(s(d),"onProcessDrawing",(function(t){var e=d.getRightCoords(d.app,t.pageX,t.pageY);d.dynamicDraw(d.app,e.x,e.y,t.shiftKey)})),a(s(d),"onAddPointDrawing",(function(t){var e=d.getRightCoords(d.app,t.pageX,t.pageY);t.shiftKey&&(e=i.getRightAngleLineLastPointCoords(d._coords,e)),d.addPoint(e.x,e.y)})),a(s(d),"onStopDrawing",(function(t){var e=d.app;("click"==t.type||"keydown"==t.type&&13==t.keyCode)&&d.testCoords(d._coords)&&(d.close(),e.removeAllEvents().setIsDraw(!1).resetNewArea()),t.stopPropagation()})),a(s(d),"edit",(function(t,e,n){var a=Object.create(d._coords);switch(t){case"move":for(var r=0,o=a.points.length;r<o;r++)a.points[r].x+=e,a.points[r].y+=n;break;case"movePoint":a.points[d.selected_point].x+=e,a.points[d.selected_point].y+=n}return a})),a(s(d),"onProcessEditing",(function(t){var e=d.app.getEditType();d.redraw(d.edit(e,t.pageX-d.editingStartPoint.x,t.pageY-d.editingStartPoint.y)),d.editingStartPoint.x=t.pageX,d.editingStartPoint.y=t.pageY})),a(s(d),"onStopEditing",(function(t){var e=d.app.getEditType();d.setCoords(d.edit(e,t.pageX-d.editingStartPoint.x,t.pageY-d.editingStartPoint.y)).redraw(),d.app.removeAllEvents()})),a(s(d),"toString",(function(){return"Polygon {points: ["+d._coords.points.map((function(t){return"["+t.x+", "+t.y+"]"})).join(", ")+"]}"})),a(s(d),"toHTMLMapElementString",(function(){return'<area shape="poly" coords="'+d._coords.points.map((function(t){return t.x+", "+t.y})).join(", ")+'"'+(d._attributes.id?' href="'+d._attributes.id+'"':"")+(d._attributes.href?' href="'+d._attributes.href+'"':"")+(d._attributes.alt?' alt="'+d._attributes.alt+'"':"")+(d._attributes.title?' title="'+d._attributes.title+'"':"")+" />"})),a(s(d),"getCoordsForDisplayingInfo",(function(){return{x:d._coords.points[0].x,y:d._coords.points[0].y}})),a(s(d),"testCoords",(function(t){return t.points.length>=3})),a(s(d),"testHTMLCoords",(function(t){return t.length>=6&&t.length%2==0})),a(s(d),"getCoordsFromHTMLArray",(function(t){if(!testHTMLCoords(t))throw new Error("This html-coordinates is not valid for polygon");for(var e=[],n=0,a=t.length/2;n<a;n++)e.push({x:t[2*n],y:t[2*n+1]});return{points:e}})),a(s(d),"getRightAngleLineLastPointCoords",(function(t,e){var n=.414,a=2.414,r=t.points.length-1,o=t.points[r],i=e.x-o.x,s=-(e.y-o.y),c=s/i,d=e.x,l=e.y;return i>0&&s>0?c>a?d=o.x:c<n?l=o.y:Math.abs(i)>Math.abs(s)?d=o.x+s:l=o.y-i:i<0&&s>0?c<-a?d=o.x:c>-n?l=o.y:Math.abs(i)>Math.abs(s)?d=o.x-s:l=o.y+i:i<0&&s<0?c>a?d=o.x:c<n?l=o.y:Math.abs(i)>Math.abs(s)?d=o.x+s:l=o.y-i:i>0&&s<0&&(c<-a?d=o.x:c>-n?l=o.y:Math.abs(i)>Math.abs(s)?d=o.x-s:l=o.y+i),{x:d,y:l}})),a(s(d),"copy",(function(t,e){var n=d.app,a=JSON.parse(t.toJSON());n.foreach(a.areas,(function(t){if(t.attributes.id==e._attributes.id){var a=t.coords;return n.foreach(t.coords.points,(function(t,e){a.points[e].x+=10,a.points[e].y+=10})),t.coords=a,t.attributes.id=y.genID(6),y.fromJSON(n,t)}}))})),a(s(d),"getCenterPoint",(function(t){var e,n,a,r;return t.map((function(t){void 0===e&&(e=t.x),void 0===n&&(n=t.x),void 0===a&&(a=t.y),void 0===r&&(r=t.y),t.x>n&&(n=t.x),t.x<e&&(e=t.x),t.y>r&&(r=t.y),t.y<a&&(a=t.y)})),{x:(n+e)/2,y:(r+a)/2}})),a(s(d),"rotate",(function(t,e){var n=d.getCenterPoint(t._coords.points),a=k(M(e)),r=x(a,t._coords.points),o=d.getCenterPoint(r);if(r=x(k(A(n.x-o.x,n.y-o.y)),r),console.log(t._seats.points),void 0!==t._seats&&void 0!==t._seats.points)try{var i=x(a,t._seats.points);t._seats.points=i,t._coords.points=r,d.redraw()}catch(t){var s=new bootstrap.Toast(document.querySelector(".toast"));document.querySelector(".toast .toast-body").innerHTML="Please allocate all seats inside this zone to make rotation.",s.show()}else t._coords.points=r,d.redraw();return t})),d.app=e,d._coords={points:n.points||[{x:0,y:0}],isOpened:n.isOpened||!1},d._el=document.createElementNS(y.SVG_NS,d._coords.isOpened?"polyline":"polygon"),void 0!==c&&(d._el.dataset.id=c.id),void 0===r&&(r=[]),d._groupEl.appendChild(d._el),d._helpers={points:[]};for(var l=0,u=d._coords.points.length;l<u;l++)d._helpers.points.push(new _(d._groupEl,d._coords.points[l].x,d._coords.points[l].y,"movePoint").setId(l));return d._selectedPoint=-1,d.redraw(),d}return n(i)}(y);a(D,"createAndStartDrawing",(function(t,e){var n=new D(t,{title:"",points:[e],isOpened:!0});return t.addEvent(t.domElements.container,"mousemove",n.onProcessDrawing.bind(n)).addEvent(t.domElements.container,"click",n.onAddPointDrawing.bind(n)).addEvent(document,"keydown",n.onStopDrawing.bind(n)).addEvent(n._helpers.points[0]._el,"click",n.onStopDrawing.bind(n)),n}));var z=function(e){r(i,e);var o=d(i);function i(e,n,r,c){var d;return t(this,i),a(s(d=o.call(this,"circle",e,n,r,c)),"setSVGCoords",(function(t){return this._el.setAttribute("cx",t.cx),this._el.setAttribute("cy",t.cy),this._el.setAttribute("r",t.radius),this._el.setAttribute("p",""),this.helpers.center.setCoords(t.cx,t.cy),this.helpers.top.setCoords(t.cx,t.cy-t.radius),this.helpers.right.setCoords(t.cx+t.radius,t.cy),this.helpers.bottom.setCoords(t.cx,t.cy+t.radius),this.helpers.left.setCoords(t.cx-t.radius,t.cy),this})),a(s(d),"setCoords",(function(t){return this._coords.cx=t.cx,this._coords.cy=t.cy,this._coords.radius=t.radius,this})),a(s(d),"dynamicDraw",(function(t,e){var n=Math.round(Math.sqrt(Math.pow(this._coords.cx-t,2)+Math.pow(this._coords.cy-e,2))),a={cx:this._coords.cx,cy:this._coords.cy,radius:n};return this.redraw(a),a})),a(s(d),"onProcessDrawing",(function(t){var e=utils.getRightCoords(t.pageX,t.pageY);this.dynamicDraw(e.x,e.y)})),a(s(d),"onStopDrawing",(function(t){var e=utils.getRightCoords(t.pageX,t.pageY);this.setCoords(this.dynamicDraw(e.x,e.y)).deselect(),app.removeAllEvents().setIsDraw(!1).resetNewArea()})),a(s(d),"edit",(function(t,e,n){var a=Object.create(this._coords);switch(t){case"move":a.cx+=e,a.cy+=n;break;case"editTop":a.radius-=n;break;case"editBottom":a.radius+=n;break;case"editLeft":a.radius-=e;break;case"editRight":a.radius+=e}return a})),a(s(d),"dynamicEdit",(function(t){return t.radius<0&&(t.radius=Math.abs(t.radius)),this.setSVGCoords(t),t})),a(s(d),"onProcessEditing",(function(t){var e=app.getEditType();return this.dynamicEdit(this.edit(e,t.pageX-this.editingStartPoint.x,t.pageY-this.editingStartPoint.y))})),a(s(d),"onStopEditing",(function(t){app.getEditType(),this.setCoords(this.onProcessEditing(t)),app.removeAllEvents()})),a(s(d),"toString",(function(){return"Circle {cx: "+this._coords.cx+", cy: "+this._coords.cy+", radius: "+this._coords.radius+"}"})),a(s(d),"toHTMLMapElementString",(function(){return'<area shape="circle" coords="'+this._coords.cx+", "+this._coords.cy+", "+this._coords.radius+'"'+(this._attributes.id?' href="'+this._attributes.id+'"':"")+(this._attributes.href?' href="'+this._attributes.href+'"':"")+(this._attributes.alt?' alt="'+this._attributes.alt+'"':"")+(this._attributes.title?' title="'+this._attributes.title+'"':"")+" />"})),a(s(d),"getCoordsForDisplayingInfo",(function(){return{x:this._coords.cx,y:this._coords.cy}})),a(s(d),"testCoords",(function(t){return t.cx&&t.cy&&t.radius})),a(s(d),"testHTMLCoords",(function(t){return 3===t.length})),a(s(d),"getCoordsFromHTMLArray",(function(t){if(!this.testHTMLCoords(t))throw new Error("This html-coordinates is not valid for circle");return{cx:t[0],cy:t[1],radius:t[2]}})),a(s(d),"createAndStartDrawing",(function(t){var e=new i({cx:t.x,cy:t.y,radius:0});return app.addEvent(app.domElements.container,"mousemove",e.onProcessDrawing.bind(e)).addEvent(app.domElements.container,"click",e.onStopDrawing.bind(e)),e})),d.app=e,d._coords={cx:n.cx||0,cy:n.cy||0,radius:n.radius||0},void 0===r&&(r=[]),d._el=document.createElementNS(y.SVG_NS,"circle"),d._groupEl.appendChild(d._el),d.helpers={center:new _(d._groupEl,n.cx,n.cy,"move"),top:new _(d._groupEl,n.cx,n.cy,"editTop"),bottom:new _(d._groupEl,n.cx,n.cy,"editBottom"),left:new _(d._groupEl,n.cx,n.cy,"editLeft"),right:new _(d._groupEl,n.cx,n.cy,"editRight")},d.redraw(),d}return n(i)}(y),N=n((function e(n,r,o){t(this,e),a(this,"drawStats",(function(){var t=this,e=this._areas,n='<table class="table" style="width:100%;min-width:700px;">';n+="<tr><th></th><th>Zone</th>",this._cfs.map((function(t){n+="<th>".concat(t.label,"</th>")})),n+="<th>Seat Count</th></tr>";var a={seatsPerZone:0,totalZones:0,totalSeats:0,totalTws:0,i:1},r=3+this._cfs.length,o=function(o){if(a.seatsPerZone=0,void 0!==e[o]._seats){for(var i in e[o]._seats.points)null!=e[o]._seats.points[i]&&1==e[o]._seats.points[i].i&&(a.seatsPerZone+=1);var s=e[o]._seats.tws?parseInt(e[o]._seats.tws):0,c=e[o]._seats.title?e[o]._seats.title:"";a.totalZones+=1,a.totalSeats+=a.seatsPerZone,a.totalTws+=s,n+="<tr><td>"+a.i+"</td><td>"+c+"</td>",t._cfs.map((function(t){n+="<td>".concat(e[o]._seats[t.id]?e[o]._seats[t.id]:"","</td>")})),n+="<td>"+a.seatsPerZone+"/"+s+"</td></tr>"}else n+='<tr><td colspan="'+r+'">'+a.i+"</td></tr>";a.i++};for(var i in e)o(i);n+='<tr><td colspan="'+r+'">Total zones: '+a.totalZones+"</td></tr>",n+='<tr><td colspan="'+r+'">Total seats in all zones: '+a.totalTws+"</td></tr>",n+='<tr><td colspan="'+r+'">Total seats available for booking: '+a.totalSeats+"</td></tr>",n+="</table>",this._el.setAttribute("style","overflow-x: scroll;"),this._el.innerHTML=n})),a(this,"structRow",(function(t){})),this._el=n,this._areas=r,this._cfs=o})),P=function(){var t,e,n={SVG_NS:"http://www.w3.org/2000/svg",CLASS_NAMES:{SELECTED:"selected",WITH_HREF:"with_href"},getOffset:function(t){var e=t.getBoundingClientRect();return{x:Math.round(e.left+window.pageXOffset),y:Math.round(e.top+window.pageYOffset)}},getRightCoords:function(t,e){return{x:t-a.getOffset("x"),y:e-a.getOffset("y")}},id:function(t){return document.getElementById(t)},hide:function(t){return t.style.display="none",this},show:function(t){return t.style.display="block",this},encode:function(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")},foreach:function(t,e){for(var n=0,a=t.length;n<a;n++)e(t[n],n)},foreachReverse:function(t,e){for(var n=t.length-1;n>=0;n--)e(t[n],n)},debug:(e=document.getElementById("debug"),function(){e.innerHTML=[].join.call(arguments," ")}),stopEvent:function(t){return t.stopPropagation(),t.preventDefault(),this},getUrlParameter:function(t){var e,n,a=window.location.search.substring(1).split("&");for(n=0;n<a.length;n++)if((e=a[n].split("="))[0]===t)return void 0===e[1]||decodeURIComponent(e[1])},getCookie:function(t){for(var e=t+"=",n=decodeURIComponent(document.cookie).split(";"),a=0;a<n.length;a++){for(var r=n[a];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(e))return unescape(r.substring(e.length,r.length))}return""},extend:function(t,e){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=e[a]?e[a]:t[a]);return n},genID:function(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;a<t;a++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},inherits:(t=function(){},function(e,n){t.prototype=n.prototype,e.prototype=new t,e.prototype.constructor=e})},a=function(){var t={wrapper:n.id("wrapper"),svg:n.id("svg"),img:n.id("img"),container:n.id("image"),seat_mapping:n.id("svg_mapping_cont"),map:null},e={CONSTRUCTORS:{rectangle:w,circle:z,polygon:D},offset:{x:0,y:0},cp:{x:0,y:0},clickTime:(new Date).getTime(),svg_width:0,svg_height:0,max_times:1,appMode:null,currentType:null,editType:null,newArea:null,selectedArea:null,mappingArea:null,cfs:[],pcfs:[],cfs_listener:null,areas:[],events:[],isDraw:!1,silent:!1,image:{src:null,filename:null,width:0,height:0},last_scroll:0,to:"",moved:!1,mapping:!1,autoAssign:!1,autoAssignRT:[],autoAlign:!1,autoAlignXY:[],autoDraw:{points:[],count:"",active:!1},updateObjectSeatPointsHistory:[],timer1:null,timer2:null},o=112,i=27,l=38,p=40,h=37,g=39,f=46,m=8,v=81,b=65,y=68,_=72,x=83,S=67,A=74,E=85,k=90;function L(){e.to&&window.clearTimeout(e.to),e.to=window.setTimeout((function(){e.offset=n.getOffset(t.container)}),100)}window.addEventListener("resize",L,!1),window.addEventListener("scroll",L,!1),t.container.addEventListener("mousedown",(function(t){t.preventDefault()}),!1),t.seat_mapping.addEventListener("mousedown",(function(t){t.preventDefault(),e.clickTime=(new Date).getTime()}),!1),t.img.addEventListener("dragstart",(function(t){t.preventDefault()}),!1);var C,T=(C=n.id("coords"),{set:function(t){C.innerHTML="x: "+t.x+", y: "+t.y},empty:function(){C.innerHTML=""}});function M(t){if("editing"===e.appMode)if("g"===t.target.parentNode.tagName)if(c.unload(),e.selectedArea=t.target.parentNode.obj,a.deselectAll(),e.selectedArea.select(),e.selectedArea.editingStartPoint={x:t.pageX,y:t.pageY},t.target.classList.contains("helper")){var r=t.target;e.editType=r.action,r.n>=0&&(e.selectedArea.selected_point=r.n),a.addEvent(a.domElements.container,"mousemove",e.selectedArea.onProcessEditing.bind(e.selectedArea)).addEvent(a.domElements.container,"mouseup",e.selectedArea.onStopEditing.bind(e.selectedArea))}else"rect"!==t.target.tagName&&"circle"!==t.target.tagName&&"polygon"!==t.target.tagName||(e.editType="move",a.addEvent(a.domElements.container,"mousemove",e.selectedArea.onProcessEditing.bind(e.selectedArea)).addEvent(a.domElements.container,"mouseup",e.selectedArea.onStopEditing.bind(e.selectedArea)));else a.deselectAll(),c.unload();else if("seating"===e.appMode){if("g"===t.target.parentNode.tagName){c.unload(),e.selectedArea=t.target.parentNode.obj,a.deselectAll(),e.selectedArea.select(),e.selectedArea.editingStartPoint={x:t.pageX,y:t.pageY};var o=t.target.parentNode.dataset.id;$("#kenzap_seat_map").attr("data-id",o),$("#zone_title").val(a.getObjectSeats(a.getSelectedArea(),"title")),$("#zone_tws").val(a.getObjectSeats(a.getSelectedArea(),"tws")),$("#zone_tns").val(a.getObjectSeats(a.getSelectedArea(),"tns")),$("#zone_price").val(a.getObjectSeats(a.getSelectedArea(),"price")),$("#zone_bgi").val(""),$("#zone_bg").attr("src","https://cdn.kenzap.com/loading.png"),$(".remove").css("display","none");var i=a.getObjectSeats(a.getSelectedArea(),"bg");void 0===i&&(i=""),i.length>12&&($("#zone_bgi").val(i),$("#zone_bg").attr("src",i),$(".remove").css("display","inline-block"),$(".remove").off(),$(".remove").on("click",(function(){if(confirm("Remove background image?")){$("#loader").fadeIn("fast");var t=new FormData,e=n.getUrlParameter("id")+"-"+o;t.append("id",e),t.append("cmd","remove_image"),t.append("type","myticket"),t.append("token",n.getCookie("kenzap_token")),$.ajax({url:"https://fileapi.kenzap.com/v1/",cmd:"remove_image",type:"post",data:t,contentType:!1,processData:!1,success:function(t){var e=t;e.success?($("#zone_bgi").val(""),$("#zone_bg").attr("src","https://cdn.kenzap.com/loading.png"),$("#loader").fadeOut("fast")):alert("Unable to save: "+e.reason)}})}}))),$("#zone_bg").off(),$(".bg-file").off(),$(".bg-file").val(null),$("#zone_bg").on("click",(function(){$(".bg-file").trigger("click")})),$(".bg-file").on("change",(function(t){var e=this;if(e.files&&e.files[0]){var r=e.files[0],i=new FormData,s=n.getUrlParameter("id")+"-"+o;i.append("file",r),i.append("id",s),i.append("cmd","store_image"),i.append("type","myticket"),i.append("token",n.getCookie("kenzap_token")),$("#loader").fadeIn("fast"),$.ajax({url:"https://fileapi.kenzap.com/v1/",cmd:"store_image",type:"post",data:i,contentType:!1,processData:!1,success:function(t){var e=t;e.success?setTimeout((function(){var t=new Date,e="https://cdn.kenzap.com/myticket/"+s+".jpeg?"+t.getTime();$("#zone_bgi").val(e),$("#zone_bg").attr("src",e),a.updateObjectSeats(a.getSelectedArea(),"bg",e),$("#loader").fadeOut("fast")}),5e3):alert("Unable to save: "+e.reason)}})}})),document.querySelector(".form-group-custom").innerHTML="",document.querySelector(".form-price-custom").innerHTML="",void 0===e.cfs&&(e.cfs=[]),void 0===e.pcfs&&(e.pcfs=[]),e.cfs.map((function(t){var e=a.structCustomField(t);document.querySelector(".form-group-custom").appendChild(e),$("#"+t.id).val(a.getObjectSeats(a.getSelectedArea(),t.id))})),$("#zone_price").fadeIn(0),e.pcfs.map((function(t){var e=a.structPriceField(t);document.querySelector(".form-price-custom").appendChild(e),$("#"+t.id).val(a.getObjectSeats(a.getSelectedArea(),t.id)),$("#zone_price").fadeOut(0)})),e.cfs_listener||document.querySelector("#zone_add_field").addEventListener("click",(function(t){var n,r=0,o=u(document.querySelectorAll(".form-group-custom .custom-field"));try{for(o.s();!(n=o.n()).done;){var i=n.value;parseInt(i.dataset.index)>r&&(r=parseInt(i.dataset.index))}}catch(t){o.e(t)}finally{o.f()}var s={id:"cf"+(r+=1),index:r,label:"Custom field",value:""},c=a.structCustomField(s);document.querySelector(".form-group-custom").appendChild(c),e.cfs.push(s),t.preventDefault()}),!1),e.cfs_listener||document.querySelector("#zone_add_price").addEventListener("click",(function(t){var n,r=0,o=u(document.querySelectorAll(".form-price-custom .custom-price-field"));try{for(o.s();!(n=o.n()).done;){var i=n.value;parseInt(i.dataset.index)>r&&(r=parseInt(i.dataset.index))}}catch(t){o.e(t)}finally{o.f()}var s={id:"pcf"+(r+=1),index:r,label:"Price variation",value:""},c=a.structPriceField(s);document.querySelector(".form-price-custom").appendChild(c),$("#zone_price").fadeOut(0),e.pcfs.push(s),t.preventDefault()}),!1),e.cfs_listener="attached";var s=document.querySelector("#kenzap_seat_map");new bootstrap.Modal(s).show()}}else if("mapping"===e.appMode)if("g"===t.target.parentNode.tagName){c.unload(),e.mappingArea=t.target.dataset.index,e.moved=!1,e.mapping=!0;var d=$("#cr"+e.mappingArea);d.offset(),$(".cr").removeClass("selected"),d.addClass("selected").removeClass("align"),e.autoAlign&&(d.addClass("align"),e.autoAlignXY||(e.autoAlignXY=[]),e.autoAlignXY.push({x:parseInt(d.attr("cx")),y:parseInt(d.attr("cy"))}),O()),e.autoAlign=!1,a.deselectAll()}else a.deselectAll(),c.unload()}t.container.addEventListener("mousemove",(function(t){T.set(n.getRightCoords(t.pageX,t.pageY))}),!1),t.seat_mapping.addEventListener("mousemove",(function(t){var n=$("#svg_mapping").offset();(new Date).getTime()-e.clickTime<400||e.mapping&&(e.moved=!0,$("#cr"+e.mappingArea).attr("cx",t.pageX-n.left),$("#cr"+e.mappingArea).attr("cy",t.pageY-n.top),$("#tx"+e.mappingArea).attr("x",t.pageX-n.left),$("#tx"+e.mappingArea).attr("y",t.pageY-n.top))}),!1),t.seat_mapping.addEventListener("mouseup",(function(t){if("circle"===t.target.tagName||"text"===t.target.tagName){$("#seat_notice").fadeOut(0),$("#seat_row,#seat_text,#seat_price").fadeIn(100);var n=a.getSelectedArea(),r=t.target.parentNode.dataset.index,o=$("#svg_mapping").offset(),i=a.getObjectSeatPoints(n,r);i||(i={x:0,y:0,r:"",t:"",p:"",i:!1}),e.moved&&(i.x=(t.pageX-o.left-e.svg_width)/e.max_times,i.y=(t.pageY-o.top-e.svg_height)/e.max_times,$("#cr"+e.mappingArea).attr("cx",t.pageX-o.left),$("#cr"+e.mappingArea).attr("cy",t.pageY-o.top),$("#tx"+e.mappingArea).attr("x",t.pageX-o.left),$("#tx"+e.mappingArea).attr("y",t.pageY-o.top),a.updateObjectSeatPoints(n,r,i)),$("#seat_text_in").val($("#tx"+r).html()).data("index",r),i.p?$("#seat_price_in").val(i.p):$("#seat_price_in").val(a.getObjectSeats(a.getSelectedArea(),"price")),i.r?$("#seat_row_in").val(i.r):$("#seat_row_in").val(a.getObjectSeats(a.getSelectedArea(),"title")),e.moved=!1,e.mapping=!1}if("circle"!==t.target.tagName&&"text"!==t.target.tagName&&"g"!==t.target.tagName&&e.autoDraw.active){var s=$("#svg_mapping").offset();if(e.autoDraw.points.push({x:t.pageX-s.left,y:t.pageY-s.top}),2==e.autoDraw.points.length){var c=e.autoDraw.points[1].x-e.autoDraw.points[0].x,d=e.autoDraw.points[1].y>e.autoDraw.points[0].y?e.autoDraw.points[1].y-e.autoDraw.points[0].y:e.autoDraw.points[0].y-e.autoDraw.points[1].y,l=Math.sqrt(c*c+d*d),p=Math.atan(d/c);console.log(" x = "+c+" y = "+d+" c = "+l);for(var h,g=l/(parseInt(e.autoDraw.count)-1),f=g,m=0,v=e.autoDraw.points[0].x,b=e.autoDraw.points[0].y;m<parseInt(e.autoDraw.count);){console.log("new while");var y,_=u(document.querySelectorAll(".cr"));try{for(_.s();!(y=_.n()).done;){var w=y.value,x=void 0===w.getAttribute("data-inside")?"true":w.getAttribute("data-inside"),S=JSON.parse(x);if(h=parseInt(w.getAttribute("data-index")),!S){document.querySelector("#cr"+h).setAttribute("cx",v),document.querySelector("#cr"+h).setAttribute("cy",b),document.querySelector("#tx"+h).setAttribute("x",v),document.querySelector("#tx"+h).setAttribute("y",b),document.querySelector("#cr"+h).setAttribute("data-inside",S),document.querySelector("#tx"+h).setAttribute("data-inside",S),console.log(h+" "+S+" newX: "+v+" newY: "+b);break}}}catch(t){_.e(t)}finally{_.f()}if(void 0===h)return;e.mappingArea=h;var A=a.getSelectedArea(),E=a.getObjectSeatPoints(A,e.mappingArea);E||(E={x:0,y:0,r:"",t:"",p:"",i:!1}),E.x=(v-e.svg_width)/e.max_times,E.y=(b-e.svg_height)/e.max_times,a.updateObjectSeatPoints(A,e.mappingArea,E);var k=f*Math.cos(p),L=Math.sqrt(f*f-k*k);v=e.autoDraw.points[0].x+k,b=e.autoDraw.points[1].y>e.autoDraw.points[0].y?e.autoDraw.points[0].y+L:e.autoDraw.points[0].y-L,m++,f+=g}e.mapping=!1,e.autoDraw.active=!1,e.autoDraw.count="",e.autoDraw.points=[]}}}),!1),t.container.addEventListener("mouseleave",(function(){T.empty()}),!1),t.seat_mapping.addEventListener("mouseleave",(function(){T.empty()}),!1),t.container.addEventListener("mousedown",M,!1),t.seat_mapping.addEventListener("mousedown",M,!1),t.seat_mapping.addEventListener("mouseover",(function(t){if("g"===t.target.parentNode.tagName&&e.autoAssign){if(e.mappingArea=t.target.dataset.index,void 0===e.mappingArea)return;if(e.mappingAreaPrev==e.mappingArea)return;void 0===e.mappingAreaPrev&&(e.mappingAreaPrev=e.mappingArea);var n=$("#cr"+e.mappingArea),r=$("#tx"+e.mappingAreaPrev);n.addClass("assign");var o=a.getSelectedArea(),i=a.getObjectSeatPoints(o,e.mappingArea);i||(i={x:0,y:0,r:"",t:"",p:"",i:!1}),e.autoAssignRT.length>0&&(i.r=e.autoAssignRT[0].r,i.t=e.autoAssignRT[0].t,i.p=e.autoAssignRT[0].p),null==i.t&&(i.t=r.html());var s=parseInt(i.t)+1;$("#tx"+e.mappingArea).html(parseInt(i.t)),e.autoAssignRT=[],e.autoAssignRT.push({r:i.r,t:s,p:i.p}),a.updateObjectSeatPoints(o,e.mappingArea,i),e.mappingAreaPrev=e.mappingArea,e.timer1&&clearTimeout(e.timer1),e.timer1=setTimeout((function(){$(".cr").removeClass("assign"),e.autoAssign=!1,e.autoAssignRT=[]}),2e3)}}),!1),t.container.addEventListener("click",(function(t){"drawing"===e.appMode&&!e.isDraw&&e.currentType&&(s.hide(),a.setIsDraw(!0),e.newArea=D.createAndStartDrawing(a,n.getRightCoords(t.pageX,t.pageY)))}),!1);var O=function(){if(e.autoAlignXY.length>1){var t,n,r,o=0;if(e.autoAlignXY[0].x>e.autoAlignXY[1].x){var i=e.autoAlignXY;e.autoAlignXY[0]=i[1],e.autoAlignXY[1]=i[0]}t=e.autoAlignXY[1].x-e.autoAlignXY[0].x,n=Math.abs(e.autoAlignXY[1].y-e.autoAlignXY[0].y),r=Math.atan(n/t);var s=[];$(".cr").each((function(t){var n=parseInt($(this).attr("cx")),a=parseInt($(this).attr("cy"));if(n-e.autoAlignXY[0].x>0&&e.autoAlignXY[1].x-n>0&&(a>=e.autoAlignXY[1].y&&a<=e.autoAlignXY[0].y||a<=e.autoAlignXY[1].y&&a>=e.autoAlignXY[0].y||a==e.autoAlignXY[1].y||a==e.autoAlignXY[1].y+1||a==e.autoAlignXY[1].y-1||a==e.autoAlignXY[1].y+2||a==e.autoAlignXY[1].y-2||a==e.autoAlignXY[1].y+3||a==e.autoAlignXY[1].y-3)){var o=n-e.autoAlignXY[0].x,i=o*Math.tan(r);console.log("a2 = "+o+" b2 = "+i),console.log("cy = "+a+" y0 = "+e.autoAlignXY[0].y+" y1 = "+e.autoAlignXY[1].y+" "+i);var c=e.autoAlignXY[1].y<e.autoAlignXY[0].y?e.autoAlignXY[0].y-i:i+e.autoAlignXY[0].y;Math.abs(a-c)<=10&&(s.push($(this).attr("data-index")),$(this).addClass("align"))}})),s.reverse();for(var c=t/(s.length+1),d=e.autoAlignXY[0].x;o<s.length;){var l=d+=c,u=void 0;u=e.autoAlignXY[1].y<e.autoAlignXY[0].y?(e.autoAlignXY[0].x-d)*Math.tan(r)+e.autoAlignXY[0].y:(e.autoAlignXY[0].x-d)*Math.tan(r)*-1+e.autoAlignXY[0].y;var p=$("#cr"+s[o]).attr("data-index");console.log("show seats  #cr"+s[o]),$("#cr"+s[o]).attr("cx",l),$("#tx"+s[o]).attr("x",l),$("#cr"+s[o]).attr("cy",u),$("#tx"+s[o]).attr("y",u);var h=a.getObjectSeatPoints(a.getSelectedArea(),p);h||(h={x:0,y:0,r:"",t:"",p:"",i:!1}),h.x=(l-e.svg_width)/e.max_times,h.y=(u-e.svg_height)/e.max_times,a.updateObjectSeatPoints(a.getSelectedArea(),p,h),o++}console.log("align start"),e.autoAlignXY=[],e.autoAlign=!1,e.timer1&&clearTimeout(e.timer1),e.timer1=setTimeout((function(){$(".cr").removeClass("align"),e.autoAlign=!1}),1e3)}e.timer2&&clearTimeout(e.timer2),e.timer2=setTimeout((function(){$(".cr").removeClass("align"),e.autoAlign=!1,e.autoAlignXY=[],console.log("align stoped")}),2e3)},N=function(t,n){var r=parseInt($("#cr"+e.mappingArea).attr("cx")),o=parseInt($("#cr"+e.mappingArea).attr("cy")),i=$("#cr"+e.mappingArea).attr("data-index");switch(t){case l:o-=1;break;case p:o+=1;break;case h:r-=1;break;case g:r+=1}$("#cr"+e.mappingArea).attr("cx",r),$("#cr"+e.mappingArea).attr("cy",o),$("#tx"+e.mappingArea).attr("x",r),$("#tx"+e.mappingArea).attr("y",o);var s=a.getSelectedArea(),c=a.getObjectSeatPoints(s,i);c||(c={x:0,y:0,r:"",t:"",p:"",i:!1}),c.x=(r-e.svg_width)/e.max_times,c.y=(o-e.svg_height)/e.max_times,a.updateObjectSeatPoints(a.getSelectedArea(),i,c)};document.addEventListener("keydown",(function(t){var n=t.ctrlKey||t.metaKey;switch(t.keyCode>47&&t.keyCode<58&&e.autoDraw.active&&(e.autoDraw.count+=t.keyCode-48+""),t.keyCode){case _:case o:break;case b:"mapping"===e.appMode&&e.selectedArea&&(console.log("KEY A"),e.autoAlign=!0,e.timer1&&clearTimeout(e.timer1),e.timer1=setTimeout((function(){e.autoAlign=!1}),1e3));break;case y:"mapping"===e.appMode&&e.selectedArea&&(console.log("draw mode"),e.autoDraw.count="",e.autoDraw.active=!0,e.autoDraw.points=[],e.timer1&&clearTimeout(e.timer1),e.timer1=setTimeout((function(){e.autoDraw.count="",e.autoDraw.active=!1}),1e4));break;case v:"mapping"===e.appMode&&e.selectedArea&&(e.autoAssign=!e.autoAssign,console.log("assign "+e.autoAssign));break;case i:e.isDraw?(e.isDraw=!1,e.newArea.remove(),e.areas.pop(),a.removeAllEvents()):"editing"===e.appMode&&(e.selectedArea.redraw(),a.removeAllEvents());break;case l:"mapping"===e.appMode&&N(l),"editing"===e.appMode&&e.selectedArea&&(e.selectedArea.move(0,-1),t.preventDefault());break;case p:"mapping"===e.appMode&&N(p),"editing"===e.appMode&&e.selectedArea&&(e.selectedArea.move(0,1),t.preventDefault());break;case h:"mapping"===e.appMode&&N(h),"editing"===e.appMode&&e.selectedArea&&(e.selectedArea.move(-1,0),t.preventDefault());break;case g:"mapping"===e.appMode&&N(g),"editing"===e.appMode&&e.selectedArea&&(e.selectedArea.move(1,0),t.preventDefault());break;case f:case m:"editing"===e.appMode&&e.selectedArea&&(a.removeObject(e.selectedArea),e.selectedArea=null,c.unload());break;case x:n&&a.saveInLocalStorage();break;case S:"editing"===e.appMode&&e.selectedArea&&n&&(t.preventDefault(),console.log("KEYS.C"),e.selectedArea=e.selectedArea.copy(I,e.selectedArea));break;case E:console.log("KEY U"),"editing"===e.appMode&&e.selectedArea&&n&&(t.preventDefault(),e.selectedArea=e.selectedArea.rotate(e.selectedArea,1));break;case A:console.log("KEY J"),"editing"===e.appMode&&e.selectedArea&&n&&(t.preventDefault(),e.selectedArea=e.selectedArea.rotate(e.selectedArea,-1));break;case k:if(console.log("KEY Z"),"mapping"===e.appMode&&n){var r=e.updateObjectSeatPointsHistory.pop();if(void 0===r)return;e.selectedArea._seats=r.seats,a.createMappingPolygon(),t.preventDefault()}}}),!1);var P,I={toJSON:function(){var t={areas:[],img:e.image.src,img_width:$("#svg").width(),cfs:[],pcfs:[]};return e.areas.map((function(e){t.areas.push(e.toJSON())})),void 0===e.cfs&&(e.cfs=[]),t.cfs=JSON.parse(JSON.stringify(e.cfs)),void 0===e.pcfs&&(e.pcfs=[]),t.pcfs=JSON.parse(JSON.stringify(e.pcfs)),JSON.stringify(t)},fromJSON:function(t){var e=JSON.parse(t);a.loadImage(e.img),e.areas.map((function(t){a.fromJSONArea(t)}))}},R=(P="seatMapCreator",{save:function(){var t=I.toJSON();window.localStorage.setItem(P,t),$("#loader").fadeIn("fast");var a=new FormData;a.append("id",n.getUrlParameter("id")),a.append("cmd","save_layout"),a.append("extra",t),$.ajax({url:"https://myticket.kenzap.cloud/backend.php",headers:{"Kenzap-Token":n.getCookie("kenzap_token")},type:"post",data:a,contentType:!1,processData:!1,success:function(t){var n=t;if(n.success){if(!e.silent){$("#loader").fadeOut("fast");var a=new bootstrap.Toast(document.querySelector(".toast"));document.querySelector(".toast .toast-body").innerHTML="Changes saved to database",a.show()}e.silent=!1,console.log("SAVED"),$("#loader").fadeOut("fast")}else alert(n.reason)}}),console.info("Editor "+t+" saved")},restore:function(){console.log("restoring"),I.fromJSON(window.localStorage.getItem(P))}});return{domElements:t,saveInLocalStorage:R.save,loadFromLocalStorage:R.restore,hide:function(){return n.hide(t.container),this},show:function(){return n.show(t.container),this},recalcOffsetValues:function(){return L(),this},setDimensions:function(e,n){return t.svg.setAttribute("width",e),t.svg.setAttribute("height",n),t.container.style.width=e+"px",t.container.style.height=n+"px",this},structCustomField:function(t){var n=document.createElement("div");n.className="custom-field form-group mb-3",n.dataset.index=t.index;var a=document.createElement("label");a.setAttribute("for","cf"+t.index);var r=document.createElement("input");r.value=t.label,r.className="cfl",r.setAttribute("autocomplete","off");var o=document.createElement("span");o.className="mdi mdi-trash-can-outline text-danger delete-cfl",o.innerHTML='                   <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">                       <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>                       <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>                   </svg>',o.dataset.type="remove",o.dataset.index=t.index;var i=document.createElement("input");return i.id="cf"+t.index,i.className="cf form-control",i.setAttribute("autocomplete","off"),o.addEventListener("click",(function(t){"remove"===t.currentTarget.dataset.type&&(confirm("Remove this field and its values for all zones?")&&(e.cfs=e.cfs.filter((function(e){return e.index!=t.target.dataset.index})),console.log(e.cfs),t.target.parentNode.parentNode.parentNode.remove()));t.preventDefault()})),r.addEventListener("input",(function(t){e.cfs=e.cfs.map((function(e){return console.log(e.index+" "+t.target.parentNode.parentNode.dataset.index),e.index==parseInt(t.target.parentNode.parentNode.dataset.index)&&(e.label=t.target.value),console.log(e),e})),t.preventDefault()})),i.addEventListener("input",(function(t){t.preventDefault()})),a.appendChild(r),a.appendChild(o),n.appendChild(a),n.appendChild(i),n},structPriceField:function(t){var n=document.createElement("div");n.className="custom-price-field form-group mb-3",n.dataset.index=t.index;var a=document.createElement("label");a.setAttribute("for","pcf"+t.index);var r=document.createElement("input");r.value=t.label,r.className="pcfl",r.setAttribute("autocomplete","off");var o=document.createElement("span");o.className="mdi mdi-trash-can-outline text-danger delete-pcfl",o.innerHTML='                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">                        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>                        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>                    </svg>',o.dataset.type="remove",o.dataset.index=t.index;var i=document.createElement("input");return i.id="pcf"+t.index,i.className="pcf form-control",i.setAttribute("autocomplete","off"),i.setAttribute("type","number"),o.addEventListener("click",(function(t){"remove"===t.target.dataset.type&&(confirm("Remove this variation and its values for all zones?")&&(e.pcfs=e.pcfs.filter((function(e){return e.index!=t.target.dataset.index})),console.log(e.pcfs),t.target.parentNode.parentNode.parentNode.remove(),0==e.pcfs&&$("#zone_price").fadeIn(0)));t.preventDefault()})),r.addEventListener("input",(function(t){e.pcfs=e.pcfs.map((function(e){return console.log(e.index+" "+t.target.parentNode.parentNode.dataset.index),e.index==parseInt(t.target.parentNode.parentNode.dataset.index)&&(e.label=t.target.value),console.log(e),e})),t.preventDefault()})),i.addEventListener("input",(function(t){t.preventDefault()})),a.appendChild(r),a.appendChild(o),n.appendChild(a),n.appendChild(i),n},loadImage:function(n){return d.showLoadIndicator(),t.img.src=n,e.image.src=n,t.img.onload=function(){d.hideLoadIndicator().hide(),a.show().setDimensions(t.img.width,t.img.height).recalcOffsetValues(),$("#polygon").trigger("click")},this},preview:(t.img.setAttribute("usemap","#map"),t.map=document.createElement("map"),t.map.setAttribute("name","map"),t.container.appendChild(t.map),function(){return c.unload(),a.setShape(null),n.hide(t.svg),t.map.innerHTML=a.getHTMLCode(),s.print(),this}),hidePreview:function(){return n.show(t.svg),t.map.innerHTML="",this},addNodeToSvg:function(e){return t.svg.appendChild(e),this},removeNodeFromSvg:function(e){return t.svg.removeChild(e),this},getOffset:function(t){switch(t){case"x":case"y":return e.offset[t]}},clear:function(){for(e.areas.length=0;t.svg.childNodes[0];)t.svg.removeChild(t.svg.childNodes[0]);return s.hide(),c.unload(),this},removeObject:function(t){return e.areas.map((function(n,a){n===t&&e.areas.splice(a,1)})),t.remove(),this},updateObjectSeats:function(t,n,a){return e.areas.map((function(r,o){r===t&&(e.areas[o]._seats[n]=a)})),this},getObjectSeats:function(t,n){var a="";return e.areas.map((function(r,o){r===t&&(void 0===e.areas[o]._seats&&(e.areas[o]._seats={}),a=e.areas[o]._seats[n])})),a},updateObjectSeatPoints:function(t,n,a){var r=this;return e.areas.map((function(o,i){if(o===t){e.updateObjectSeatPointsHistory.push(JSON.parse(JSON.stringify(e.areas[i]))),void 0!==a.x&&(a.x=parseInt(1e3*a.x)/1e3),void 0!==a.y&&(a.y=parseInt(1e3*a.y)/1e3),void 0===a.t&&(a.t=parseInt(n)+1),null==a.t&&(a.t=parseInt(n)+1),""==a.t&&(a.t=parseInt(n)+1),a.t=a.t+"",void 0!==a.p&&(a.p=a.p+""),void 0!==a.r&&(a.r=a.r+"");for(var s=document.querySelector("#svg_mapping_cont polygon").getAttribute("points").split(" "),c=[],d=0;d<s.length;d+=2)c.push({x:parseFloat(s[d]),y:parseFloat(s[d+1])});var l=parseInt(document.querySelector("#cr"+n).getAttribute("cx")),u=parseInt(document.querySelector("#cr"+n).getAttribute("cy"));a.i=r.isPointInsidePolygon([l,u],c),document.querySelector("#cr"+n).setAttribute("data-inside",a.i),document.querySelector("#tx"+n).setAttribute("data-inside",a.i),console.log(a),e.areas[i]._seats.points[n]=a}})),this},getObjectSeatPoints:function(t,n){var a="";return e.areas.map((function(r,o){r===t&&(a=e.areas[o]._seats.points[n])})),a},isPointInsidePolygon:function(t,e){for(var n=t[0],a=t[1],r=!1,o=0,i=e.length-1;o<e.length;i=o++){var s=e[o].x,c=e[o].y,d=e[i].x,l=e[i].y;c>a!=l>a&&n<(d-s)*(a-c)/(l-c)+s&&(r=!r)}return r},setSilent:function(t){e.silent=t},resetAreaSeats:function(){e.updateObjectSeatPointsHistory.push(JSON.parse(JSON.stringify(e.selectedArea))),e.selectedArea._seats.points=[],a.createMappingPolygon()},updateSeatNumber:function(){if(a.getSelectedArea()){var t=a.getObjectSeatPoints(a.getSelectedArea(),$("#seat_text_in").data("index"));t.t=$("#seat_text_in").val(),$("#tx"+$("#seat_text_in").data("index")).html($("#seat_text_in").val()),a.updateObjectSeatPoints(a.getSelectedArea(),$("#seat_text_in").data("index"),t)}},updateSeatRow:function(){if(a.getSelectedArea()){var t=a.getObjectSeatPoints(a.getSelectedArea(),$("#seat_text_in").data("index"));t.r=$("#seat_row_in").val(),a.updateObjectSeatPoints(a.getSelectedArea(),$("#seat_row_in").data("index"),t)}},updateSeatPrice:function(){if(a.getSelectedArea()){var t=a.getObjectSeatPoints(a.getSelectedArea(),$("#seat_text_in").data("index"));t.p=$("#seat_price_in").val(),a.updateObjectSeatPoints(a.getSelectedArea(),$("#seat_price_in").data("index"),t)}},getLayout:function(){return e.areas},exportSeats:function(){var t=I.toJSON();document.querySelector("#exportTextArea").innerHTML=t;var e=document.querySelector("#kenzap_export");new bootstrap.Modal(e).show()},importSeats:function(){try{var t=$("#importTextArea").val();console.log(t),t=t.trim();var e=JSON.parse(t);a.loadLayout("-",e),$("#kenzap_export").modal("hide")}catch(t){console.log(t),alert("Error parsing JSON structure")}},deselectAll:function(){return e.areas.map((function(t){t.deselect()})),this},getIsDraw:function(){return e.isDraw},setIsDraw:function(t){return e.isDraw=t,this},setMode:function(t){return e.appMode=t,this},getMode:function(){return e.appMode},setShape:function(t){return e.currentType=t,this},getShape:function(){return e.currentType},addObject:function(t){return e.areas.push(t),this},getNewArea:function(){return e.newArea},resetNewArea:function(){return e.newArea=null,this},getSelectedArea:function(){return e.selectedArea},setSelectedArea:function(t){return e.selectedArea=t,this},getEditType:function(){return e.editType},setFilename:function(t){return e.image.filename=t,this},getFilename:function(){return e.image.filename},setEditClass:function(){return t.container.classList.remove("draw"),t.container.classList.add("edit"),this},setDrawClass:function(){return t.container.classList.remove("edit"),t.container.classList.add("draw"),this},setDefaultClass:function(){return t.container.classList.remove("edit"),t.container.classList.remove("draw"),this},addEvent:function(t,n,a){return e.events.push(new r(t,n,a)),this},removeAllEvents:function(){return e.events.map((function(t){t.remove()})),e.events.length=0,this},getHTMLCode:function(t){var a="";if(t){if(!e.areas.length)return"0 objects";a+=n.encode('<img src="'+e.image.filename+'" alt="" usemap="#map" />')+"<br />"+n.encode('<map name="map">')+"<br />",n.foreachReverse(e.areas,(function(t){a+="&nbsp;&nbsp;&nbsp;&nbsp;"+n.encode(t.toHTMLMapElementString())+"<br />"})),a+=n.encode("</map>")}else n.foreachReverse(e.areas,(function(t){a+=t.toHTMLMapElementString()}));return a},fromJSONArea:function(t){var e;switch(t.type){case"polygon":e=new D(a,t.coords,t.seats,t.attributes);break;case"circle":e=new z(a,t.coords,t.seats,t.attributes);break;case"rectangle":e=new w(a,t.coords,t.seats,t.attributes)}if(!e)throw new Error("This area type is not valid");return a.setIsDraw(!0),a.setIsDraw(!1).resetNewArea(),e},getJSONCF:function(){return e.cfs},fromJSONCF:function(t){e.cfs=t},getJSONPCF:function(){return e.pcfs},fromJSONPCF:function(t){e.pcfs=t},foreach:function(t,e){for(var n=0,a=t.length;n<a;n++)e(t[n],n)},loadLayout:function(t,e){var n=new Image;n.src="-"==t?e.img:"https://cdn.kenzap.com/myticket/"+t,n.onload=function(){a.loadImage(n.src).setFilename(n.src),a.fromJSONCF(e.cfs),a.fromJSONPCF(e.pcfs),e.areas.map((function(t){a.fromJSONArea(t)})),$("#polygon").trigger("click")}},createMappingPolygon:function(){var t,r=$("#svg_mapping"),o=$("#img_section"),i=$(window).width()-100,s=$(window).height()-100,c=a.getSelectedArea();if($("#seat_mapping, #top_toolbar, #seat_notice").fadeIn(),$("#seat_row,#seat_text,#seat_price").fadeOut(0),r.html(""),$("#ul-slider-5").length){(t=c._seats.height)||(t=100);var d=document.getElementById("ul-slider-5");d.noUiSlider&&d.noUiSlider.destroy(),noUiSlider.create(d,{start:[t],connect:[!0,!1],range:{min:[25],max:[125]}},!0),d.noUiSlider.on("slide",(function(t,e,n,o,i){console.log(parseInt(t[0])),a.updateObjectSeats(a.getSelectedArea(),"height",parseInt(t[0])),$(".cr").each((function(e){$(this).attr("r",r.attr("data-height")*(parseInt(t[0])/100))}))}))}var l,u,p=0,h=0,g=0;c._coords.points.map((function(t){return g++,p+=t.x,h+=t.y,t})),l=p/g,u=h/g;var f,m=0,v=0;c._coords.points_rel=[],c._coords.points.map((function(t){var e=Math.abs(l-t.x);e=Math.abs(l-t.x),v=e>v?e:v,e=Math.abs(u-t.y),m=e>m?e:m,c._coords.points_rel.push({x:t.x-l,y:t.y-u})})),r.css("width",i),r.css("height",s);var b=i/2/v,y=s/2/m;f=b<y?b:y,b=0,y=0;var _=0,w=0,x=!0,S=0,A=999999999,E=c._coords.points_rel.map((function(t){var e=t.x*f+i/2,n=t.y*f+s/2;return x||(b+=_*t.y*f,y+=w*t.x*f),_=t.x*f,w=t.y*f,x=!1,e>S&&(S=e),e<A&&(A=e),e+" "+n})).join(" "),k=document.createElementNS(n.SVG_NS,"g"),L=document.createElementNS(n.SVG_NS,"polygon");L.setAttribute("points",E),k.appendChild(L),r.append(k);var C=9999999;c._coords.points.map((function(t){return t.y*f<C&&(C=t.y*f),t.x*f+" "+t.y*f})).join(" ");var T=c._seats.bg;T.length>0?(r.css("background-image","url("+T+")"),r.css("background-position","center"),r.css("background-size",S-A+"px auto"),r.css("background-repeat","no-repeat"),o.attr("src",T)):r.css("background-image","none"),o.attr("src",a.getFilename()),o.css("width",parseInt($("#svg").width())*f),o.css("left",i/2-l*f+80),o.css("top",s/2-u*f+80);var M=Math.round(Math.abs(y-b))/2,O=c._seats.tws,D=c._seats.price,z=Math.sqrt(M/O);for(r.attr("data-height",z/2),z*=parseInt(t)/100,g=0;g<O;){var N=document.createElementNS(n.SVG_NS,"g");N.setAttribute("id","dc"+g),N.setAttribute("data-index",g);var P=document.createElementNS(n.SVG_NS,"circle");P.setAttribute("id","cr"+g),P.setAttribute("cx",z/2),P.setAttribute("cy",z/2),P.setAttribute("r",z/2),P.setAttribute("class","cr"),P.setAttribute("data-index",g),P.setAttribute("data-inside",!1);var I=document.createElementNS(n.SVG_NS,"text");if(I.setAttribute("id","tx"+g),I.setAttribute("x",z/2),I.setAttribute("y",z/2),I.setAttribute("dy",".3em"),I.setAttribute("stroke-width","1px"),I.setAttribute("text-anchor","middle"),I.setAttribute("stroke","#51c5cf"),I.setAttribute("data-index",g),I.setAttribute("data-inside",!1),I.setAttribute("data-toggle","popover"),I.setAttribute("title","Seat Settings"),I.setAttribute("data-content","test"),I.setAttribute("data-price",D),I.innerHTML=g+1,null==c._seats.points&&(c._seats.points=[]),c._seats.points[g]){var R=c._seats.points[g].x*f+i/2,j=c._seats.points[g].y*f+s/2,H=c._seats.points[g].i;P.setAttribute("cx",R),P.setAttribute("cy",j),P.setAttribute("data-inside",H),I.setAttribute("x",R),I.setAttribute("y",j),I.setAttribute("data-inside",H),c._seats.points[g].t&&(I.innerHTML=c._seats.points[g].t)}N.appendChild(P),N.appendChild(I),N.obj=this,r.append(N),console.log(c._seats.points),g++}g=0,a.setMode("mapping"),e.max_times=f,e.cp.x=l,e.cp.y=u,e.svg_width=i/2,e.svg_height=s/2,$("#svg_mapping").offset()}}}();function r(t,e,n){this.target=t,this.eventType=e,this.func=n,t.addEventListener(e,n,!1)}r.prototype.remove=function(){this.target.removeEventListener(this.eventType,this.func,!1)};var o,i,s=(o=n.id("code"),i=n.id("code_content"),o.querySelector(".close_button").addEventListener("click",(function(t){n.hide(o),t.preventDefault()}),!1),{print:function(){i.innerHTML=a.getHTMLCode(!0),n.show(o)},hide:function(){n.hide(o)}}),c=function(){var t,e,r,o,i,s=n.id("edit_details"),c=s.querySelector("h5"),d=n.id("href_attr"),l=n.id("alt_attr"),u=n.id("title_attr"),p=n.id("save_details"),h=s.querySelector(".close_button"),g=s.querySelectorAll("p");function f(){s.classList.remove("changed"),n.foreach(g,(function(t){t.classList.remove("changed")}))}function m(){t=null,f(),n.hide(s)}function v(t,e){s.style.left=t+5+"px",s.style.top=e+5+"px"}function b(t){v(e+t.pageX-o,r+t.pageY-i)}function y(t){e=e+t.pageX-o,r=r+t.pageY-i,v(e,r),a.removeAllEvents()}function _(){s.classList.add("changed"),this.parentNode.classList.add("changed")}return p.addEventListener("click",(function(e){t.setInfoAttributes({id:id_attr.value,href:d.value,alt:l.value,title:u.value}),t[t.href?"setStyleOfElementWithHref":"unsetStyleOfElementWithHref"](),f(),m(),e.preventDefault()}),!1),d.addEventListener("keydown",(function(t){t.stopPropagation()}),!1),l.addEventListener("keydown",(function(t){t.stopPropagation()}),!1),u.addEventListener("keydown",(function(t){t.stopPropagation()}),!1),d.addEventListener("change",_,!1),l.addEventListener("change",_,!1),u.addEventListener("change",_,!1),h.addEventListener("click",m,!1),c.addEventListener("mousedown",(function(t){o=t.pageX,i=t.pageY,a.addEvent(document,"mousemove",b),a.addEvent(c,"mouseup",y),t.preventDefault()}),!1),{load:function(a,o,i){t=a,d.id=a.id?a.id:"",d.value=a.href?a.href:"",l.value=a.alt?a.alt:"",u.value=a.title?a.title:"",n.show(s),o&&i&&v(e=o,r=i)},unload:m}}();!function(){var t=n.id("from_html_wrapper"),e=n.id("code_input"),a=n.id("load_code_button"),r=t.querySelector(".close_button");function o(){n.hide(t)}a.addEventListener("click",(function(t){Area.createAreasFromHTMLOfMap(e.value)&&o(),t.preventDefault()}),!1),r.addEventListener("click",o,!1)}();var d=function(){var t=n.id("get_image_wrapper"),e=t.querySelector(".close_button"),r=n.id("loading"),o=n.id("button"),i=null,s=null,c=function(){var t=n.id("dropzone"),e=t.querySelector(".clear_button"),r=n.id("sm_img");function o(){r.src="",n.hide(r).hide(e),t.classList.remove("error"),s=d}return t.addEventListener("dragover",(function(t){n.stopEvent(t)}),!1),t.addEventListener("dragleave",(function(t){n.stopEvent(t)}),!1),t.addEventListener("drop",(function(d){n.stopEvent(d);var l=new FileReader,u=d.dataTransfer.files[0];!function(t){switch(t){case"image/jpeg":case"image/gif":case"image/png":return!0}return!1}(u.type)?(o(),t.classList.add("error")):(t.classList.remove("error"),l.readAsDataURL(u),l.onload=function(t){r.src=t.target.result,r.style.display="inline-block",i=u.name,n.show(e),s=c;var o=new FormData,d=n.getUrlParameter("id");o.append("file",u),o.append("id",d),o.append("cmd","store_image"),o.append("type","myticket"),o.append("token",n.getCookie("kenzap_token")),$("#loader").fadeIn("fast"),$.ajax({url:"https://fileapi.kenzap.com/v1/",cmd:"store_image",type:"post",data:o,contentType:!1,processData:!1,success:function(t){var e=JSON.parse(t);e.success?setTimeout((function(){var t=new Date,e="https://cdn.kenzap.com/myticket/"+d+".jpeg?"+t.getTime();$("#img").attr("src",e),a.loadImage(e).setFilename(e),$("#loader").fadeOut("fast")}),12e3):alert("Unable to save: "+e.reason)}})})}),!1),e.addEventListener("click",o,!1),{clear:o,init:function(){t.draggable=!0,this.clear(),n.hide(r).hide(e)},test:function(){return Boolean(r.src)},getImage:function(){return r.src}}}(),d=function(){var t=n.id("url"),e=t.parentNode.querySelector(".clear_button");function a(){setTimeout((function(){t.value.length?(n.show(e),s=d):(n.hide(e),s=c)}),0)}function r(){t.value="",n.hide(e),t.classList.remove("error"),s=d}return t.addEventListener("keypress",a,!1),t.addEventListener("change",a,!1),t.addEventListener("paste",a,!1),e.addEventListener("click",r,!1),{clear:r,init:function(){this.clear(),n.hide(e)},test:function(){return function(t){var e=t.trim().split(".");if(e.length>1)switch(e[e.length-1].toLowerCase()){case"jpg":case"jpeg":case"gif":case"png":return!0}return!1}(t.value)?(t.classList.remove("error"),!0):(t.classList.add("error"),!1)},getImage:function(){var e=t.value.split("/");return i=e[e.length-1],t.value.trim()}}}();function l(){c.clear(),d.clear(),s=null,n.show(t)}function u(){n.hide(t)}return n.hide(r),c.init(),d.init(),window.onload=function(e){var r;(r=new FormData).append("id",n.getUrlParameter("id")),r.append("cmd","get_layout"),$.ajax({url:"https://myticket.kenzap.cloud/backend.php",type:"post",headers:{"Kenzap-Token":n.getCookie("kenzap_token")},data:r,contentType:!1,processData:!1,success:function(e){var n,r=e;if(r.success){$("#loader").fadeOut("fast");var o=r.img;""!=o&&a.loadLayout(o,r.layout.extra)}else{switch(r.code){case 10:window.location.replace("https://auth.kenzap.com/?app=65432108792785&redirect=https://myticket.kenzap.cloud/"),t=!0,clearInterval(myTimer);break;case 11:alert("Ooops. Something went wrong. Please close this window and try again!"),t=!0,clearInterval(myTimer)}console.log("Oops! "+r.reason)}(n=document.querySelector(".loader"))&&(n.style.display="none")}})},o.addEventListener("click",(function(t){s===d&&d.test()?a.loadImage(d.getImage()).setFilename(i):s===c&&c.test()&&a.loadImage(c.getImage()).setFilename(i),t.preventDefault()}),!1),e.addEventListener("click",u,!1),{show:function(){return a.hide(),l(),this},hide:function(){return a.show(),u(),this},showLoadIndicator:function(){return n.show(r),this},hideLoadIndicator:function(){return n.hide(r),this}}}();d.show(),function(){var t=n.id("nav").getElementsByTagName("li"),e=n.id("save");n.id("load"),n.id("rectangle"),n.id("circle");var r=n.id("polygon"),o=n.id("edit");n.id("clear"),n.id("from_html"),n.id("to_html"),n.id("preview");var i=n.id("new_image");n.id("show_help");var s=n.id("seats"),l=n.id("saveSeatMap"),u=n.id("seat_row_in"),p=n.id("seat_text_in"),h=n.id("seat_price_in"),g=n.id("seat_mapping_close"),f=n.id("reset_zone_btn"),m=n.id("export"),v=n.id("import"),b=n.id("stats_btn");function y(){n.foreach(t,(function(t){t.classList.remove(n.CLASS_NAMES.SELECTED)}))}function _(t){y(),t.classList.add(n.CLASS_NAMES.SELECTED)}function w(t){a.saveInLocalStorage(),t.preventDefault()}e.addEventListener("click",w,!1),r.addEventListener("click",(function(t){$(".btna").removeClass("btn-primary").addClass("btn-outline-primary"),$("#"+this.id).addClass("btn-primary").removeClass("btn-outline-primary"),a.setMode("drawing").setDrawClass().setShape(this.id).deselectAll().hidePreview(),c.unload(),_(this),t.preventDefault()}),!1),o.addEventListener("click",(function(t){$(".btna").removeClass("btn-primary").addClass("btn-outline-primary"),$("#"+this.id).addClass("btn-primary").removeClass("btn-outline-primary"),"editing"===a.getMode()?(a.setMode(null).setDefaultClass().deselectAll(),y(),n.show(domElements.svg)):(a.setShape(null).setMode("editing").setEditClass(),_(this)),a.hidePreview(),t.preventDefault()}),!1),i.addEventListener("click",(function(t){confirm("This operation may break your current layout. Continue?")&&(a.setIsDraw(!1).hide().hidePreview(),y(),d.show()),t.preventDefault()}),!1),s.addEventListener("click",(function(t){$(".btna").removeClass("btn-primary").addClass("btn-outline-primary"),$("#"+this.id).addClass("btn-primary").removeClass("btn-outline-primary"),"seating"===a.getMode()?(a.setMode(null).setDefaultClass().deselectAll(),y()):(a.setShape(null).setMode("seating").setEditClass(),_(this)),a.hidePreview(),t.preventDefault()}),!1),l.addEventListener("click",(function(t){$("#kenzap_seat_map").attr("data-id"),a.updateObjectSeats(a.getSelectedArea(),"title",$("#zone_title").val()),a.updateObjectSeats(a.getSelectedArea(),"tws",$("#zone_tws").val()),a.updateObjectSeats(a.getSelectedArea(),"tns",$("#zone_tns").val()),a.updateObjectSeats(a.getSelectedArea(),"price",$("#zone_price").val()),a.updateObjectSeats(a.getSelectedArea(),"bg",$("#zone_bgi").val()),a.getJSONCF().map((function(t){a.updateObjectSeats(a.getSelectedArea(),t.id,$("#"+t.id).val())})),a.getJSONPCF().map((function(t){a.updateObjectSeats(a.getSelectedArea(),t.id,$("#"+t.id).val())})),a.createMappingPolygon()}),!1),g.addEventListener("click",(function(t){$("#top_toolbar").fadeOut(),$("#seat_mapping").fadeOut(),a.setSilent(!0),a.setMode("seating"),w(t),t.preventDefault()}),!1),u.addEventListener("keyup",(function(t){setTimeout((function(){a.updateSeatRow()}),200)}),!1),p.addEventListener("keyup",(function(t){setTimeout((function(){a.updateSeatNumber()}),200)}),!1),h.addEventListener("keyup",(function(t){setTimeout((function(){a.updateSeatPrice()}),200)}),!1),f.addEventListener("click",(function(t){setTimeout((function(){confirm("Reset all allocated seats?")&&a.resetAreaSeats()}),200)}),!1),m.addEventListener("click",(function(t){a.exportSeats()}),!1),v.addEventListener("click",(function(t){a.clear(),a.importSeats()}),!1),b.addEventListener("click",(function(t){new N(document.getElementById("stats-body"),a.getLayout(),a.getJSONCF()).drawStats()}),!1)}()},I={state:{firstLoad:!0,ajaxQueue:0},init:function(){!function(t,e){if(!Array.from(document.querySelectorAll("script")).some((function(e){return e.src==t}))){var n=document.createElement("script");n.onload=e,n.src=t,document.getElementsByTagName("head")[0].appendChild(n)}}("https://account.kenzap.com/js/nouislider.js",(function(){})),I.getData()},getData:function(){v(),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain",Authorization:"Bearer "+g("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":g("kenzap_token"),"Kenzap-Sid":h()},body:JSON.stringify({query:{locale:{type:"locale",id:g("lang")}}})}).then((function(t){return t.json()})).then((function(t){t.success?(!function(t){t.header&&localStorage.setItem("header",t.header);var e=document.createElement("div");e.innerHTML=localStorage.getItem("header"),e=e.firstChild,document.body.prepend(e),Function(document.querySelector("#k-script").innerHTML).call("test"),window.i18n.init(t.locale)}(t),I.loadHomeStructure(),I.renderPage(),P()):f(t)})).catch((function(t){console.error("Error:",t)}))},renderPage:function(t){!function(t){var e,n='<ol class="breadcrumb mt-2 mb-0">',a=u(t);try{for(a.s();!(e=a.n()).done;){var r=e.value;void 0===r.link?n+='<li class="breadcrumb-item">'.concat(r.text,"</li>"):n+='<li class="breadcrumb-item"><a href="'.concat(r.link,'">').concat(r.text,"</a></li>")}}catch(t){a.e(t)}finally{a.f()}n+="</ol>",document.querySelector(".bc").innerHTML=n}([{link:p("https://dashboard.kenzap.cloud"),text:__("Dashboard")},{link:p("/"),text:__("MyTicket")},{text:__("Edit Layout")}])},initListeners:function(){console.log("initListeners "),m(".rename-layout",I.listeners.renameLayout),m(".duplicate-layout",I.listeners.duplicateLayout),m(".remove-layout",I.listeners.removeLayout),m(".btn-add",I.listeners.addLayout),m(".btn-modal",I.listeners.modalSuccessBtn)},listeners:{addLayout:function(t){t.preventDefault();var e=document.querySelector(".modal"),n=new bootstrap.Modal(e);e.querySelector(".modal-title").innerHTML=__("Add Layout"),e.querySelector(".btn-primary").innerHTML=__("Add"),e.querySelector(".btn-secondary").innerHTML=__("Cancel"),t.currentTarget.dataset.id;var a='\n            <div class="form-cont">\n                <div class="form-group mb-3">\n                    <label for="p-title" class="form-label">'.concat(__("Title"),'</label>\n                    <input type="text" class="form-control" id="p-title" autocomplete="off" placeholder="').concat(__("Arena.."),'" value="').concat("",'">\n                    <ol class="mt-3 form-text">\n                        <li>Enter layout title</li>\n                        <li>Click add button</li>\n                        <li>Start creating layout</li>\n                    </ol>\n                </div>                <p class="mt-2 form-text fs-8">Need help in designing your hall or stadium? <a target="_blank" href="https://kenzap.com/seat-reservation-in-wordpress-setup-service-1014779/">View examples</a>.</p>\n            </div>');e.querySelector(".modal-body").innerHTML=a,I.listeners.modalSuccessBtnFunc=function(t){t.preventDefault();var a={};if(a.title=e.querySelector("#p-title").value,a.title.length<4)alert(__("Please provide longer title"));else{var r=new URLSearchParams;r.append("cmd","add_layout"),r.append("title",a.title),v(),fetch("https://myticket.kenzap.cloud/backend.php",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+g("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":g("kenzap_token"),"Kenzap-Sid":h()},body:r}).then((function(t){return t.json()})).then((function(t){t.success?(n.hide(),I.getData()):f(t)})).catch((function(t){console.error("Error:",t)}))}},n.show(),setTimeout((function(){return e.querySelector("#p-title").focus()}),100)},duplicateLayout:function(t){if(t.preventDefault(),confirm(__("Duplicate this layout?"))){var e=t.currentTarget.dataset.id;t.preventDefault();var n=new URLSearchParams;n.append("cmd","duplicate_layout"),n.append("id",e),v(),fetch("https://myticket.kenzap.cloud/backend.php",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+g("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":g("kenzap_token"),"Kenzap-Sid":h()},body:n}).then((function(t){return t.json()})).then((function(t){t.success?I.getData():f(t)})).catch((function(t){console.error("Error:",t)}))}},removeLayout:function(t){if(t.preventDefault(),confirm(__("Permanently remove this layout?"))){var e=t.currentTarget.dataset.id;t.preventDefault();var n=new URLSearchParams;n.append("cmd","remove_layout"),n.append("id",e),v(),fetch("https://myticket.kenzap.cloud/backend.php",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+g("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":g("kenzap_token"),"Kenzap-Sid":h()},body:n}).then((function(t){return t.json()})).then((function(t){t.success?I.getData():f(t)})).catch((function(t){console.error("Error:",t)}))}},renameLayout:function(t){t.preventDefault();var e=document.querySelector(".modal"),n=new bootstrap.Modal(e);e.querySelector(".modal-title").innerHTML=__("Rename Layout"),e.querySelector(".btn-primary").innerHTML=__("Rename"),e.querySelector(".btn-secondary").innerHTML=__("Cancel");var a=t.currentTarget.dataset.id,r=t.currentTarget.dataset.title,o='\n            <div class="form-cont">                <div class="form-group mb-3">                    <label for="p-title" class="form-label">'.concat(__("Title"),'</label>                    <input type="text" class="form-control" id="p-title" autocomplete="off" placeholder="" value="').concat(r,'">                </div>            </div>');e.querySelector(".modal-body").innerHTML=o,I.listeners.modalSuccessBtnFunc=function(t){t.preventDefault();var r={};if(r.title=e.querySelector("#p-title").value,r.title.length<4)alert(__("Please provide longer title"));else{var o=new URLSearchParams;o.append("cmd","rename_layout"),o.append("title",r.title),o.append("id",a),v(),fetch("https://myticket.kenzap.cloud/backend.php",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+g("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":g("kenzap_token"),"Kenzap-Sid":h()},body:o}).then((function(t){return t.json()})).then((function(t){t.success?(n.hide(),I.getData()):f(t)})).catch((function(t){console.error("Error:",t)}))}},n.show(),setTimeout((function(){return e.querySelector("#p-title").focus()}),100)},modalSuccessBtn:function(t){I.listeners.modalSuccessBtnFunc(t)},modalSuccessBtnFunc:null},loadHomeStructure:function(){document.querySelector("#contents").innerHTML=function(t){return'\n\n        \x3c!-- seat mapping overlay controls --\x3e\n        <div id="seat_mapping">\n            <div id="reset_zone" class="seat_head" style=""><span id="reset_zone_btn">Reset</span></div>\n            <div id="top_toolbar">\n                <div id="seat_mapping_close">×</div>\n                <div id="seat_size" class="seat_head">Seat Size:</div>\n                <div id="ul-slider-5" class="ul-slider slider-success"></div>\n                <div id="seat_notice" class="seat_head" style="margin-left: 350px;">Click on seat to drag it to a desired location.</div>\n                <div id="seat_row" class="seat_head">Seat Row: <input id="seat_row_in" autocomplete="off" type="text" maxlength="6" class="form-control-sm" placeholder="-" ></div>\n                <div id="seat_text" class="seat_head">Seat Number: <input id="seat_text_in" autocomplete="off" type="text" maxlength="6" class="form-control-sm" placeholder="-" ></div>\n                <div id="seat_price" class="seat_head">Seat Price: <input id="seat_price_in" autocomplete="off" type="text" maxlength="12" class="form-control-sm" placeholder="-" ></div>\n                <div id="seat_text_vis" class="seat_head">\n                <div class="checkbox" >\n                    <input type="checkbox" id="seat_text_vis_cb" class="checkbox__input">\n                    <label for="seat_text_vis_cb" class="checkbox__label">View Seat Numbers</label>\n                </div>\n                </div>\n            </div>\n\n            <div id="svg_mapping_cont">\n                <img id="img_section" src="" alt="section preview" >\n                <svg xmlns="http://www.w3.org/2000/svg" version="1.2" baseProfile="tiny" id="svg_mapping"> </svg>\n            </div>\n\n            <div style="width:0%;height:100%;float:right;overflow-y:scroll;padding:20px;display: none;">\n                <ul id="svg_seats"> </ul>\n            </div>\n\n        </div>\n        \n        <div class="container p-edit">\n            <div class="d-flex justify-content-between bd-highlight mb-3">\n                <nav class="bc" aria-label="breadcrumb"></nav>\n            </div>\n            <div class="row">\n                <div class="col-lg-12 grid-margin stretch-card">\n                    <div class="card border-white shadow-sm">\n                        <div class="card-body">\n                            <div id="wrapper">\n                                <header id="header">\n                                    <nav id="nav" class="clearfix">\n                                        <div class="btn-group" role="group" aria-label="Basic example">\n                                            <button id="polygon" type="button" class="btn btna btn-outline-primary">'.concat(t("draw"),'</button>\n                                            <button id="edit" type="button" class="btn btna btn-outline-primary">').concat(t("edit"),'</button>\n                                            <button id="seats" type="button" class="btn btna btn-outline-primary">').concat(t("seats"),'</button>\n                                            <button id="save" type="button" class="btn btna btn-outline-primary">').concat(t("save"),'</button>\n                                            <button id="new_image" type="button" class="btn btna btn-outline-primary">').concat(t("image"),'</button>\n                                            <button id="export" type="button" class="btn btn-outline-primary">').concat(t("export"),'</button>\n                                            <div class="more input-group dropdown">\n                                                <button id="more" type="button" class="btn btn-outline-primary" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">\n                                                <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/></svg></button>\n                                                <div class="dropdown-menu">\n                                                    <a class="dropdown-item" target="_blank" href="https://kenzap.com/seat-reservation-in-wordpress-setup-service-1014779/">').concat(t("Integration service"),'</a>\n                                                    <a class="dropdown-item" target="_blank" href="https://kenzap.blog/how-to-create-custom-concert-hall-in-wordpress-with-seat-reservation/">').concat(t("Free tutorial"),'</a>\n                                                    <a class="dropdown-item" target="_blank" href="#" data-bs-toggle="modal" data-bs-target="#kenzap_import">').concat(t("Import layout"),'</a>\n                                                    <a id="stats_btn" class="dropdown-item" target="_blank" href="#" data-bs-toggle="modal" style="" data-bs-target="#kenzap_stats">').concat(t("Layout stats"),'</a>\n                                                    <div role="separator" class="dropdown-divider"></div>\n                                                    <a class="dropdown-item" target="_blank" href="https://kenzap.com/myticket-events-plugin/">').concat(t("Community"),'</a>\n                                                </div>\n                                            </div>\n                                        </div>\n\n                                    </nav>\n                                    <div id="coords"></div>\n                                    <div id="debug"></div>\n                                </header>\n                                <div id="image_wrapper">\n                                    <div id="image">\n                                    <img src="" alt="#" id="img" style="max-width:1052px" />\n                                    <svg xmlns="http://www.w3.org/2000/svg" style="max-width:1052px" version="1.2" baseProfile="tiny" id="svg"></svg>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div id="get_image_wrapper">\n                                <div id="get_image">\n                                    <span title="close" class="close_button"></span>\n                                    <div id="loading">').concat(t("Loading"),'</div>\n                                    <div id="file_reader_support">\n                                        <label>').concat(t("Drag an image of your layout below"),'</label>\n                                        <div id="dropzone">\n                                            <span class="clear_button" title="clear">x</span>\n                                            <img src="" alt="preview" id="sm_img" />\n                                        </div>\n                                    </div>\n\n                                    <button id="button" type="button" style="margin-top:50px;" class="btn btn-outline-success ">').concat(t("Upload This Layout"),'</button>\n\n                                    <div style="display: none;">\n                                        <label for="url">type a url</label>\n                                        <span id="url_wrapper">\n                                            <span class="clear_button" title="clear">x</span>\n                                            <input type="text" id="url" />\n                                        </span>\n                                        <button id="button">').concat(t("OK"),'</button>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- For html image map code --\x3e\n        <div id="code">\n          <span class="close_button" title="close"></span>\n          <div id="code_content"></div>\n        </div>\n\n        \x3c!-- Edit details block --\x3e\n        <form id="edit_details">\n          <h5>Attributes</h5>\n          <span class="close_button" title="close"></span>\n          <p>\n            <label for="href_attr">href</label>\n            <input type="text" id="href_attr" />\n          </p>\n          <p>\n            <label for="alt_attr">alt</label>\n            <input type="text" id="alt_attr" />\n          </p>\n          <p>\n            <label for="title_attr">title</label>\n            <input type="text" id="title_attr" />\n          </p>\n          <button id="save_details">Save</button>\n        </form>\n\n        \x3c!-- From html block --\x3e\n        <div id="from_html_wrapper">\n          <form id="from_html_form">\n            <h5>Loading areas</h5>\n            <span class="close_button" title="close"></span>\n            <p>\n              <label for="code_input">Enter your html code:</label>\n              <textarea id="code_input"></textarea>\n            </p>\n            <button id="load_code_button">Load</button>\n          </form>\n        </div>\n\n\n\n\n\n        <div id="kenzap_seat_map" class="modal">\n            <div class="modal-dialog" role="document">\n                \x3c!-- Modal content --\x3e\n                <div class="modal-content">\n        \n                    <div class="modal-header">\n                        <h5 class="modal-title">').concat(t("Zone Settings"),'</h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                    </div>\n        \n                    <div class="modal-body">\n                        <div class="form-cont">\n                        \n                            <div class="form-group mb-3">\n                                <label for="zone_title" class="form-label">').concat(t("Zone label"),'</label>\n                                <input type="text" class="form-control" id="zone_title" autocomplete="off" placeholder="A2 or 1001">\n                            </div>\n                \n                            <div class="form-group mb-3">\n                                <label for="zone_tws" class="form-label">').concat(t("Number of tickets with seat reservation"),'</label>\n                                <input type="number" class="form-control" id="zone_tws" autocomplete="off" placeholder="0" value="0">\n                            </div>\n                \n                            <div class="form-group mb-3">\n                                <label for="zone_tns" class="form-label">').concat(t("Number of tickets without seat reservation"),'</label>\n                                <input type="number" class="form-control" id="zone_tns" autocomplete="off" placeholder="0" value="0">\n                            </div>\n                \n                            <div class="form-group mb-3">\n                                <label for="zone_price" class="form-label">').concat(t("Default ticket price for entire zone"),'</label>\n                                <input type="number" class="form-control" id="zone_price" autocomplete="off" placeholder="0" value="0">\n                            </div>\n                \n                            <div class="form-price-custom">\n                \n                            </div>\n                \n                            <p class="form-link mb-1" style="text-align:right;"><a id="zone_add_price" href="#" data-attached="false">add price variation</a><a href="https://kenzap.blog/how-to-create-custom-concert-hall-in-wordpress-with-seat-reservation/#pricing" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info mb-2" viewBox="0 0 16 16">\n                                <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>\n                                </svg></a>\n                            </p>\n                \n                \n                            <div class="form-group mb-3">\n                                <label for="zone_bg">').concat(t("Zone background (optional)"),'</label>\n                                <div>\n                                <img id="zone_bg" src="https://cdn.kenzap.com/loading.png" />\n                                <input type="hidden" id="zone_bgi" value="">\n                                <input type="file" name="img[]" class="dn bg-file" style="display:none;">\n                                <span class="remove" title="Remove">×</span>\n                                </div>\n                            </div>\n                \n                            <div class="form-group-custom">\n                \n                            </div>\n                \n                            <p class="form-link" style="text-align:right;">\n                                <a id="zone_add_field" href="#" data-attached="false">').concat(t("add custom field"),'</a>\n                                <a href="https://kenzap.blog/how-to-customize-pdf-ticket-with-myticket-events-plugin/#extension-fields" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info mb-2" viewBox="0 0 16 16">\n                                    <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>\n                                    </svg>\n                                </a>\n                            </p>\n                        \n                        </div>\n                    </div>\n                    \n                    <div class="modal-footer">\n                        <button id="saveSeatMap" type="button" class="btn btn-primary btn-modal" data-bs-dismiss="modal">').concat(t("Continue"),'</button>\n                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">').concat(t("Cancel"),'</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    \n    \n        <div id="kenzap_export" class="modal">\n            <div class="modal-dialog" role="document">\n                \x3c!-- Modal content --\x3e\n                <div class="modal-content">\n        \n                    <div class="modal-header">\n                        <h5 class="modal-title">').concat(t("Export Layout"),'</h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                    </div>\n        \n                    <div class="modal-body">\n        \n                        <textarea class="form-control" id="exportTextArea" rows="4"></textarea>\n            \n                        <ol class="mt-2" >\n                            <li>').concat(t("Copy layout data above"),'</li>\n                            <li>Install <b><a target="_blank" href="https://wordpress.org/plugins/myticket-events/" target="_blank">MyTicket Events</a> </b> plugin</li>\n                            <li>').concat(t("Add <b>MyTicket Hall</b> block to your website"),"</li>\n                            <li>").concat(t("Paste the code under Layout / Seat Code in the right pane"),"</li>\n                            <li>").concat(t('For large layout imports refer to <b><a target="_blank" href="https://kenzap.blog/importing-layouts-with-5000-seats-myticket-events-plugin/">this guide</a></b>'),'</li>\n                        </ol>\n            \n                        <p style="font-size:10pt;margin-top:20px;font-style: italic;">').concat(t('Need help in designing your hall or stadium layout? <a target="_blank" href="https://kenzap.com/seat-reservation-in-wordpress-setup-service-1014779/">Contact support</a>.'),'</p>\n                    </div>\n        \n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-success" data-bs-dismiss="modal">').concat(t("Done"),'</button>\n                        <button type="button" class="btn btn-outline-dark btn-fw" data-bs-dismiss="modal">').concat(t("Cancel"),'</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    \n\n        <div id="kenzap_import" class="modal">\n            <div class="modal-dialog" role="document">\n                \x3c!-- Modal content --\x3e\n                <div class="modal-content">\n        \n                    <div class="modal-header">\n                        <h5 class="modal-title" id="ModalLabel">').concat(t("Import Layout"),'</h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                    </div>\n        \n                    <div class="modal-body">\n        \n                        <textarea class="form-control" id="importTextArea" rows="4"></textarea>\n            \n                        <ol class="mt-4">\n                            <li>1. Backup current layout (make a copy)</li>\n                            <li>2. Verify JSON data is valid</li>\n                            <li>3. Paste your existing layout here</li>\n                        </ol>\n            \n                        <p class="text-danger" style="font-size:10pt;margin-top:20px;font-style: italic;">Warning. Wrong JSON structure may break current layout.</p>\n                    </div>\n        \n                    <div class="modal-footer">\n                        <button id="import" type="button" class="btn btn-success" data-bs-dismiss="modal">').concat(t("Import"),'</button>\n                        <button type="button" class="btn btn-outline-dark btn-fw" data-bs-dismiss="modal">').concat(t("Cancel"),'</button>\n                    </div>\n                </div>\n            </div> \n        </div>\n    \n\n        <div id="kenzap_stats" class="modal">\n            <div class="modal-dialog" role="document">\n                \x3c!-- Modal content --\x3e\n                <div class="modal-content">\n        \n                    <div class="modal-header">\n                        <h5 class="modal-title" id="ModalLabel">').concat(t("Layout Stats"),'</h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                    </div>\n        \n                    <div id="stats-body" class="modal-body">\n        \n        \n                    </div>\n                </div>\n            </div>\n        </div>\n\n\n        <div class="modal" tabindex="-1">\n            <div class="modal-dialog">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h5 class="modal-title"></h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                    </div>\n                    <div class="modal-body">\n\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-primary btn-modal"></button>\n                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="toast-cont position-fixed bottom-0 p-2 m-4 end-0 align-items-center">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>\n                </div>\n            </div>\n        </div>\n        \n    ')}(__)},initFooter:function(){var t,e;t=__("Copyright © "+(new Date).getFullYear()+' <a class="text-muted" href="https://kenzap.com/" target="_blank">Kenzap</a>. All rights reserved.'),e=__("Kenzap Cloud Services - Dashboard"),document.querySelector("footer .row").innerHTML='\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">'.concat(t,'</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">').concat(e,"</span>\n    </div>")}};I.init()}();
