!function(){"use strict";const t=(t,...e)=>{if(0===(t=String(t)).length)return"";return((t,e,...n)=>{let a=(t,e)=>(e.forEach(((e,n)=>{t=t.replace("%"+(n+1)+"$",e)})),t);return void 0===window.i18n||void 0===window.i18n.state.locale.values[t]?a(t,n):a(e(window.i18n.state.locale.values[t]),n)})(t,(t=>t.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),...e)},e=()=>{let t=document.querySelector(".loader");t&&(t.style.display="block")},n=t=>{let e=new URLSearchParams(window.location.search),n=e.get("sid")?e.get("sid"):"",a=-1==t.indexOf("?")?"?sid="+n:"&sid="+n;return t+a},a=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},o=()=>{let t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},r=t=>{let e=t+"=",n=decodeURIComponent(document.cookie).split(";");for(let t=0;t<n.length;t++){let a=n[t];for(;" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return""},c=()=>{let t=localStorage.hasOwnProperty("header")&&localStorage.hasOwnProperty("header-version")?localStorage.getItem("header-version"):0,e=window.location.hostname+"/"+o()+"/"+r("locale");return e!=r("check")&&(t=0,console.log("refresh")),((t,e,n)=>{let a="";if(n){let t=new Date;t.setTime(t.getTime()+24*n*60*60*1e3),a=";expires="+t.toUTCString()}document.cookie=t+"="+(escape(e)||"")+a+";path=/;domain=.kenzap.cloud"})("check",e,5),t};r("kenzap_api_key"),r("locale")&&r("locale"),c(),r("kenzap_token"),o();const l=t=>{if(console.log(t),isNaN(t.code)){let e=t;try{e=JSON.stringify(e)}catch(t){}let n=new URLSearchParams;return n.append("cmd","report"),n.append("sid",o()),n.append("token",r("kenzap_token")),n.append("data",e),fetch("https://api-v1.kenzap.cloud/error/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded"},body:n}),void alert("Can not connect to Kenzap Cloud")}if(401===t.code){if(-1!=window.location.href.indexOf("localhost"))return void alert(t.reason);location.href="https://auth.kenzap.com/?app=65432108792785&redirect="+window.location.href}else alert(t.reason)},i=(t,e)=>{if(document.querySelector(t))for(let n of document.querySelectorAll(t))n.removeEventListener("click",e,!0),n.addEventListener("click",e,!0)};var d={state:{firstLoad:!0,ajaxQueue:0},init:function(){d.getData()},getData:function(){d.state.firstLoad&&e(),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain",Authorization:"Bearer "+r("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":a()},body:JSON.stringify({query:{locale:{type:"locale",id:r("lang")}}})}).then((function(t){return t.json()})).then((function(t){t.success?((t=>{if(t.header&&localStorage.setItem("header",t.header),!document.querySelector("#k-script")){let t=document.createElement("div");t.innerHTML=localStorage.getItem("header"),t=t.firstChild,document.body.prepend(t),Function(document.querySelector("#k-script").innerHTML).call("test")}t.locale&&window.i18n.init(t.locale)})(t),d.getLayouts(t)):l(t)})).catch((function(t){console.error("Error:",t)}))},getLayouts:function(e){fetch("https://api.kenzap.com/myticket/?cmd=get_layouts",{method:"get",headers:{Accept:"application/json","Content-type":"text/plain","Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":a()}}).then((function(t){return t.json()})).then((function(n){var a;n.success?(d.loadHomeStructure(),d.renderPage(n),d.initListeners(),a=t("MyTicket 2.0.8 by %1$Kenzap%2$. ❤️ Licensed %3$GPLv3%4$.",'<a class="text-muted" href="https://kenzap.com/" target="_blank">',"</a>",'<a class="text-muted" href="https://github.com/kenzap/ecommerce" target="_blank">',"</a>"),document.querySelector("footer .row").innerHTML='\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">'.concat(a,'</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">').concat("","</span>\n    </div>"),d.state.firstLoad=!1):l(e)})).catch((function(t){console.error("Error:",t)}))},renderPage:function(e){var a=document;(t=>{let e='<ol class="breadcrumb mt-2 mb-0">';for(let n of t)void 0===n.link?e+=`<li class="breadcrumb-item">${n.text}</li>`:e+=`<li class="breadcrumb-item"><a href="${n.link}">${n.text}</a></li>`;e+="</ol>",document.querySelector(".bc").innerHTML=e})([{link:n("https://dashboard.kenzap.cloud?launcher=myticket"),text:t("Home")},{link:n("/"),text:t("MyTicket")},{text:t("Layouts")}]);var o="",r=0;for(var c in e.layouts)r++,o+="\n            <tr>\n                <td>".concat(parseInt(c)+1,'</td>\n                <td><a href="').concat(n("/layout-edit/?id="+e.layouts[c].id),'">').concat(e.layouts[c].title,'</a></td>\n                <td style="display:none;">').concat(e.layouts[c].count_zones,'</td>\n                <td style="display:none;">').concat(e.layouts[c].count_seats,'</td>\n                <td style="text-align:right;" class="">\n                    <button class="btn btn-sm dropdown-toggle" type="button" id="dropdownMenuSizeButton').concat(c,'" data-i="').concat(c,'" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">').concat(t("Option"),'</button>\n                    <div class="dropdown-menu" aria-labelledby="dropdownMenuSizeButton').concat(c,'" >\n                        <a class="dropdown-item edit-layout" href="').concat(n("/layout-edit/?id="+e.layouts[c].id),'" target="_self" >').concat(t("Edit"),'</a>\n                        <a class="dropdown-item duplicate-layout" href="#" data-toggle="modal" data-_id="').concat(e.layouts[c]._id,'" data-id="').concat(e.layouts[c].id,'" >').concat(t("Duplicate"),'</a>\n                        <a class="dropdown-item rename-layout" href="#" data-toggle="modal" data-_id="').concat(e.layouts[c]._id,'" data-id="').concat(e.layouts[c].id,'" data-title="').concat(e.layouts[c].title,'">').concat(t("Rename"),'</a>\n                        <div class="dropdown-divider"></div>\n                        <a class="dropdown-item remove-layout" href="#" data-toggle="modal" data-_id="').concat(e.layouts[c]._id,'" data-id="').concat(e.layouts[c].id,'" >').concat(t("Remove"),"</a>\n                    </div>\n                </td>\n            </tr>");a.querySelector(".layout_list").innerHTML=0==r?"<tr><td>".concat(t("No layouts to display yet"),"</td><td></td><td></td><td></td><td></td></tr>"):o,(()=>{let t=document.querySelector(".loader");t&&(t.style.display="none")})()},initListeners:function(){console.log("initListeners "),i(".rename-layout",d.listeners.renameLayout),i(".duplicate-layout",d.listeners.duplicateLayout),i(".remove-layout",d.listeners.removeLayout),d.state.firstLoad&&(i(".btn-add",d.listeners.addLayout),i(".btn-modal",d.listeners.modalSuccessBtn))},listeners:{addLayout:function(n){n.preventDefault();var o=document.querySelector(".modal"),c=new bootstrap.Modal(o);o.querySelector(".modal-title").innerHTML=t("Add Layout"),o.querySelector(".btn-primary").innerHTML=t("Add"),o.querySelector(".btn-secondary").innerHTML=t("Cancel"),n.currentTarget.dataset.id;var i,s='\n            <div class="form-cont">\n                <div class="form-group mb-3">\n                    <label for="p-title" class="form-label">'.concat(t("Title"),'</label>\n                    <input type="text" class="form-control" id="p-title" autocomplete="off" placeholder="').concat(t("Arena.."),'" value="').concat((i="",0===(i=String(i)).length?"":i.replace(/[&<>'"]/g,(t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"}[t])))),'">\n                    <ol class="mt-3 form-text">\n                        <li>').concat(t("Enter layout title"),"</li>\n                        <li>").concat(t("Click add button"),"</li>\n                        <li>").concat(t("Start creating layout"),'</li>\n                    </ol>\n                </div>\n                <p class="mt-2 form-text fs-8">').concat(t("Need help in designing your hall or stadium? %1$View examples%2$.",'<a target="_blank" href="https://kenzap.com/seat-reservation-in-wordpress-setup-service-1014779/">',"</a>"),"</p>\n            </div>");o.querySelector(".modal-body").innerHTML=s,d.listeners.modalSuccessBtnFunc=function(n){n.preventDefault();var i={};if(i.title=o.querySelector("#p-title").value,i.title.length<4)alert(t("Please provide longer title"));else{var s=new URLSearchParams;s.append("cmd","add_layout"),s.append("title",i.title),e(),fetch("https://api.kenzap.com/myticket/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+r("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":a()},body:s}).then((function(t){return t.json()})).then((function(t){t.success?(c.hide(),d.getData()):l(t)})).catch((function(t){console.error("Error:",t)}))}},c.show(),setTimeout((function(){return o.querySelector("#p-title").focus()}),100)},duplicateLayout:function(n){if(n.preventDefault(),confirm(t("Duplicate this layout?"))){var o=n.currentTarget.dataset.id;n.preventDefault();var c=new URLSearchParams;c.append("cmd","duplicate_layout"),c.append("id",o),e(),fetch("https://api.kenzap.com/myticket/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+r("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":a()},body:c}).then((function(t){return t.json()})).then((function(t){t.success?d.getData():l(t)})).catch((function(t){console.error("Error:",t)}))}},removeLayout:function(n){if(n.preventDefault(),confirm(t("Permanently remove this layout?"))){var i=n.currentTarget.dataset.id;n.preventDefault();var s=new URLSearchParams;s.append("cmd","remove_layout"),s.append("id",i),e(),fetch("https://api.kenzap.com/myticket/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+r("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":a()},body:s}).then((function(t){return t.json()})).then((function(t){t.success?d.getData():l(t)})).catch((function(t){console.error("Error:",t)})),fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r("kenzap_api_key"),"Kenzap-Locale":r("locale")?r("locale"):"en","Kenzap-Header":c(),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":o()},body:JSON.stringify({query:{layout:{type:"delete",key:"myticket-layout",sid:o(),id:n.currentTarget.dataset._id}}})}).then((function(t){return t.json()})).then((function(t){t.success||l(t)})).catch((function(t){l(t)}))}},renameLayout:function(n){n.preventDefault();var o=document.querySelector(".modal"),c=new bootstrap.Modal(o);o.querySelector(".modal-title").innerHTML=t("Rename Layout"),o.querySelector(".btn-primary").innerHTML=t("Rename"),o.querySelector(".btn-secondary").innerHTML=t("Cancel");var i=n.currentTarget.dataset.id,s=n.currentTarget.dataset.title,u='\n            <div class="form-cont">                <div class="form-group mb-3">                    <label for="p-title" class="form-label">'.concat(t("Title"),'</label>                    <input type="text" class="form-control" id="p-title" autocomplete="off" placeholder="" value="').concat(s,'">                </div>            </div>');o.querySelector(".modal-body").innerHTML=u,d.listeners.modalSuccessBtnFunc=function(n){n.preventDefault();var s={};if(s.title=o.querySelector("#p-title").value,s.title.length<4)alert(t("Please provide longer title"));else{var u=new URLSearchParams;u.append("cmd","rename_layout"),u.append("title",s.title),u.append("id",i),e(),fetch("https://api.kenzap.com/myticket/",{method:"post",headers:{Accept:"application/json","Content-type":"application/x-www-form-urlencoded",Authorization:"Bearer "+r("kenzap_api_key"),"Kenzap-Header":localStorage.hasOwnProperty("header"),"Kenzap-Token":r("kenzap_token"),"Kenzap-Sid":a()},body:u}).then((function(t){return t.json()})).then((function(t){t.success?(c.hide(),d.getData()):l(t)})).catch((function(t){console.error("Error:",t)}))}},c.show(),setTimeout((function(){return o.querySelector("#p-title").focus()}),100)},modalSuccessBtn:function(t){d.listeners.modalSuccessBtnFunc(t)},modalSuccessBtnFunc:null},loadHomeStructure:function(){d.state.firstLoad&&(document.querySelector("#contents").innerHTML='\n        <div class="container p-edit">\n            <div class="d-flex justify-content-between bd-highlight mb-3">\n                <nav class="bc" aria-label="breadcrumb"></nav>\n                <button class="btn btn-primary btn-add" type="button">'.concat(t("Add layout"),'</button>\n            </div>\n            <div class="row">\n\n                <div class="col-lg-12 grid-margin stretch-card">\n                    <div class="card border-white shadow-sm">\n                        <div class="card-body">\n                        <h4 class="card-title">').concat(t("Layout List"),'</h4>\n                        <p class="form-text">\n                            ').concat(t("Click on <code>option &gt; edit</code> to set up layout."),'\n                        </p>\n                        <div class="table-responsive">\n                            <table class="table table-hover table-borderless align-middle table-striped table-p-list" style="min-width: 800px;">\n                                <thead>\n                                    <tr>\n                                    <th>').concat(t("ID"),"</th>\n                                    <th>").concat(t("Title"),'</th>\n                                    <th class="d-none">').concat(t("Zones"),'</th>\n                                    <th class="d-none">').concat(t("Seats"),'</th>\n                                    <th style="text-align:right;"></th>\n                                    </tr>\n                                </thead>\n                                <tbody class="layout_list">\n                                    <tr>\n                                    <td></td><td></td><td></td><td></td><td></td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n\n        <div class="modal" tabindex="-1">\n            <div class="modal-dialog">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h5 class="modal-title"></h5>\n                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                    </div>\n                    <div class="modal-body">\n\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="btn btn-primary btn-modal"></button>\n                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="position-fixed bottom-0 p-2 m-4 end-0 align-items-center">\n            <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive"\n                aria-atomic="true" data-bs-delay="3000">\n                <div class="d-flex">\n                    <div class="toast-body"></div>\n                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"\n                        aria-label="Close"></button>\n                </div>\n            </div>\n        </div>\n        \n    '))}};d.init()}();
